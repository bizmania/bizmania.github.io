// ==UserScript==
// @name bm-userscript
// @version 7.4.9
// @namespace https://github.com/bizmania
// @description Visual improvements for bizmania.ru
// @author bizmania
// @homepage https://github.com/bizmania/bm-userscript#readme
// @updateURL https://bizmania.github.io/plugin/bm-userscript.meta.js
// @downloadURL https://bizmania.github.io/plugin/bm-userscript.user.js
// @license https://opensource.org/licenses/MIT
// @match https://bizmania.ru/*
// @require https://cdn.jsdelivr.net/npm/@trim21/gm-fetch@0.1.15
// @require https://cdn.jsdelivr.net/npm/axios@1.6.8
// @require https://cdn.jsdelivr.net/npm/excellentexport@3.9.6
// @require https://cdn.jsdelivr.net/npm/p-queue@8.0.1
// @connect bizmania.github.io
// @connect bizmania.ru
// @grant GM.xmlHttpRequest
// @grant GM_addStyle
// ==/UserScript==

(()=>{"use strict";var __webpack_modules__={792:module=>{var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}if(Object.create){Events.prototype=Object.create(null);if(!(new Events).__proto__)prefix=false}function EE(fn,context,once){this.fn=fn;this.context=context;this.once=once||false}function addListener(emitter,event,fn,context,once){if(typeof fn!=="function"){throw new TypeError("The listener must be a function")}var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;if(!emitter._events[evt])emitter._events[evt]=listener,emitter._eventsCount++;else if(!emitter._events[evt].fn)emitter._events[evt].push(listener);else emitter._events[evt]=[emitter._events[evt],listener];return emitter}function clearEvent(emitter,evt){if(--emitter._eventsCount===0)emitter._events=new Events;else delete emitter._events[evt]}function EventEmitter(){this._events=new Events;this._eventsCount=0}EventEmitter.prototype.eventNames=function eventNames(){var names=[],events,name;if(this._eventsCount===0)return names;for(name in events=this._events){if(has.call(events,name))names.push(prefix?name.slice(1):name)}if(Object.getOwnPropertySymbols){return names.concat(Object.getOwnPropertySymbols(events))}return names};EventEmitter.prototype.listeners=function listeners(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++){ee[i]=handlers[i].fn}return ee};EventEmitter.prototype.listenerCount=function listenerCount(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];if(!listeners)return 0;if(listeners.fn)return 1;return listeners.length};EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return false;var listeners=this._events[evt],len=arguments.length,args,i;if(listeners.fn){if(listeners.once)this.removeListener(event,listeners.fn,undefined,true);switch(len){case 1:return listeners.fn.call(listeners.context),true;case 2:return listeners.fn.call(listeners.context,a1),true;case 3:return listeners.fn.call(listeners.context,a1,a2),true;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),true;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),true;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),true}for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}listeners.fn.apply(listeners.context,args)}else{var length=listeners.length,j;for(i=0;i<length;i++){if(listeners[i].once)this.removeListener(event,listeners[i].fn,undefined,true);switch(len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++){args[j-1]=arguments[j]}listeners[i].fn.apply(listeners[i].context,args)}}}return true};EventEmitter.prototype.on=function on(event,fn,context){return addListener(this,event,fn,context,false)};EventEmitter.prototype.once=function once(event,fn,context){return addListener(this,event,fn,context,true)};EventEmitter.prototype.removeListener=function removeListener(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn){clearEvent(this,evt);return this}var listeners=this._events[evt];if(listeners.fn){if(listeners.fn===fn&&(!once||listeners.once)&&(!context||listeners.context===context)){clearEvent(this,evt)}}else{for(var i=0,events=[],length=listeners.length;i<length;i++){if(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context){events.push(listeners[i])}}if(events.length)this._events[evt]=events.length===1?events[0]:events;else clearEvent(this,evt)}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){var evt;if(event){evt=prefix?prefix+event:event;if(this._events[evt])clearEvent(this,evt)}else{this._events=new Events;this._eventsCount=0}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;if(true){module.exports=EventEmitter}},3558:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onAnalyticsPage=void 0;const upLoadAllPages_1=__webpack_require__(6843);const onAnalyticsPage=async()=>{const dlp=document.location.pathname;const sp=new URLSearchParams(document.location.search);(0,upLoadAllPages_1.upLoadAllPages)();switch(true){case dlp.startsWith("/analitics/construction"):{break}}};exports.onAnalyticsPage=onAnalyticsPage},5193:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(3558),exports)},6880:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onAnimalFarmPage=void 0;const upProductionSale_1=__webpack_require__(9894);const onAnimalFarmPage=async()=>{const sp=new URLSearchParams(document.location.search);const animalFarmId=Number(sp.get("id"));const tab=sp.get("tab")??"unit";const stab=sp.get("stab")??"sales";switch(tab){case"unit":{break}case"goods":switch(stab){case"sales":{(0,upProductionSale_1.upProductionSale)();break}}break;case"supply":{break}case"sale":{break}case"divisions":{break}case"reports":{break}}};exports.onAnimalFarmPage=onAnimalFarmPage},8551:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(6880),exports)},6964:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onCalculatorPage=void 0;const addDownloadButton_1=__webpack_require__(3006);const addProductsFilter_1=__webpack_require__(3420);const addProductsPane_1=__webpack_require__(6052);const onCalculatorPage=async()=>{(0,addProductsFilter_1.addProductsFilter)();(0,addProductsPane_1.addProductsPane)();(0,addDownloadButton_1.addDownloadButton)()};exports.onCalculatorPage=onCalculatorPage},8739:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(6964),exports)},3006:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addDownloadButton=void 0;const createIconButton_1=__webpack_require__(8166);const addDownloadButton=async()=>{const linkHolderEl=document.querySelector("div.pad12 div.pad12 h3");const padH3Els=document.querySelectorAll("div.pad12 h3");const tableEl=document.querySelector(".datatable");const rowEls=tableEl?.tBodies[0]?.rows;if(!padH3Els.length||!rowEls||!linkHolderEl){return}const name=padH3Els[3]?.innerText??"";const rows=[...rowEls].map((({cells})=>[name,cells[0].innerText,cells[1].innerText,parseFloat(cells[2].innerText),parseFloat(cells[4].innerText.replace(/\s+/g,""))]));const csvContent="data:text/csv;charset=utf-8,"+rows.map((e=>e.join(","))).join("\n")+"\n";const encodedUri=encodeURI(csvContent);const button=(0,createIconButton_1.createIconButton)({href:encodedUri,title:" [ Скачать данные ]",icon:"fa-file-excel-o",parentElement:linkHolderEl});button.setAttribute("href",encodedUri);button.setAttribute("download",`prod.${name}.csv`)};exports.addDownloadButton=addDownloadButton},3420:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addProductsFilter=void 0;const addProductsFilter=async()=>{const productsIframeEl=document.querySelector("#product_frm");const frm=productsIframeEl?.contentWindow?.document;if(!frm){return}const tableEl=frm.querySelector("table");const tableCells=[...frm.querySelectorAll("td")];const elI=document.createElement("input");elI.type="text";elI.placeholder="поиск ... ";elI.onkeyup=event=>{const value=event.target.value;tableCells.forEach((td=>{td.style.display=(td.textContent??"").toLowerCase().includes(value.toLowerCase())?"":"none"}))};tableEl?.parentElement?.insertBefore(elI,tableEl)};exports.addProductsFilter=addProductsFilter},6052:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addProductsPane=void 0;const addProductsPane=async()=>{const selectEl=document.querySelector("#content > form > div:nth-child(1) > table > tbody > tr:nth-child(1) > td:nth-child(2) > select");const productsIframeEl=document.querySelector("#product_frm");const frm=productsIframeEl?.contentWindow?.document;if(!selectEl||!frm){return}const cityId=selectEl.value;const imageEls=frm.querySelectorAll("td > img");const newLinkEls=[...imageEls].map((imageEl=>{const newLinkEl=document.createElement("a");const newImageEl=document.createElement("img");const nextCell=imageEl.parentNode?.nextSibling;const linkEl=nextCell?.querySelector("a");const productId=linkEl?.href?.match(/productComboSelect\(\"product\",(\d+),/)?.[1]??"0";newLinkEl.title=linkEl?.textContent??"";newLinkEl.href=`/units/produce/calculator/?product=${productId}&city=${cityId}`;newLinkEl.appendChild(newImageEl);newImageEl.src=imageEl.src;return newLinkEl}));const newCellEl=document.createElement("td");newCellEl.colSpan=6;const newRowEl=document.createElement("tr");newRowEl.appendChild(newCellEl);const tableBodyEl=document.querySelector("#content > form > div:nth-child(1) > table > tbody");tableBodyEl?.appendChild(newRowEl);newLinkEls.forEach((el=>{newCellEl.appendChild(el);newCellEl.appendChild(document.createTextNode(" "))}))};exports.addProductsPane=addProductsPane},2634:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onCityPage=void 0;const upLoadAllPages_1=__webpack_require__(6843);const onCityPage=async()=>{const sp=new URLSearchParams(document.location.search);const tab=sp.get("tab")??"summary";(0,upLoadAllPages_1.upLoadAllPages)()};exports.onCityPage=onCityPage},6164:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(2634),exports)},9250:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onCompanyPage=void 0;const upLoadAllPages_1=__webpack_require__(6843);const upCityButtons_1=__webpack_require__(4637);const upUnits_1=__webpack_require__(3430);const onCompanyPage=async()=>{const sp=new URLSearchParams(document.location.search);const id=Number(sp.get("id"));const tab=sp.get("tab")??"company";(0,upLoadAllPages_1.upLoadAllPages)();switch(tab){case"company":{(0,upUnits_1.upUnits)();(0,upCityButtons_1.upCityButtons)();break}case"members":{break}}};exports.onCompanyPage=onCompanyPage},758:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(9250),exports)},4637:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upCityButtons=void 0;const upCityButtons=async()=>{const cityCells=document.querySelectorAll("#content > table:nth-child(4) > tbody > tr:nth-child(2) > td:nth-child(2) > table > tbody > tr[valign='middle'] > td:nth-child(2)");cityCells.forEach((cell=>{const a=cell.querySelector("a");if(!a)return;const cityId=Number(a.href.match(/\?id=(\d+)/)?.[1]??"0");const cityTitle=a.textContent??"";if(cityId===0)return;const nextCell=cell.nextElementSibling;if(!nextCell)return;nextCell.style.display="flex";nextCell.style.gap="5px";nextCell.appendChild(createMarketLink(cityId,cityTitle));nextCell.appendChild(createCalcLink(cityId,cityTitle));console.log(cityId)}))};exports.upCityButtons=upCityButtons;const createMarketLink=(cityId,cityTitle)=>{const link=document.createElement("a");link.href=`/market/units/?location=${cityId}`;link.title=`Перейти на рынок предприятий города ${cityTitle}`;const img=document.createElement("img");img.src="/img/fansale.png";img.style.width="20px";img.style.height="auto";link.appendChild(img);return link};const createCalcLink=(cityId,cityTitle)=>{const link=document.createElement("a");link.href=`/units/produce/calculator/?city=${cityId}`;link.title=`Перейти на страницу расчета для города ${cityTitle}`;const img=document.createElement("img");img.src="/img/products/tablet.gif";img.style.width="20px";img.style.height="auto";link.appendChild(img);return link}},3430:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upUnits=void 0;const getCompany_1=__webpack_require__(3697);const getUnitDivisions_1=__webpack_require__(8796);const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const upUnits=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const members=await upUnitsActions();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(members,null,4))}});(0,createIconButton_1.createIconButton)({icon:"fa-download",iconTitle:"Скачать в буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const members=await upUnitsActions(true);(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(members,null,4))}})};exports.upUnits=upUnits;const upUnitsActions=async(download=false)=>{const company=await(0,getCompany_1.getCompany)();if(company&&download){const promises=company.cities.map((city=>city.units)).flat().map((async unit=>{unit.divisions=await(0,getUnitDivisions_1.getUnitDivisions)(unit.url)??[]}));await Promise.all(promises)}return company}},5433:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onConstructionPointsPage=void 0;const upConstructionPoints_1=__webpack_require__(3539);const onConstructionPointsPage=async()=>{const sp=new URLSearchParams(document.location.search);const tab=sp.get("tab")??"construction";switch(tab){case"construction":{(0,upConstructionPoints_1.upConstructionPoints)();break}}};exports.onConstructionPointsPage=onConstructionPointsPage},6818:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(5433),exports);__exportStar(__webpack_require__(590),exports)},590:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onProducePointsPage=void 0;const upProducePoints_1=__webpack_require__(4390);const onProducePointsPage=async()=>{const sp=new URLSearchParams(document.location.search);const id=Number(sp.get("id"));const tab=sp.get("tab")??"producepoints";switch(tab){case"producepoints":{(0,upProducePoints_1.upProducePoints)();break}}};exports.onProducePointsPage=onProducePointsPage},3539:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upConstructionPoints=void 0;const createIconButton_1=__webpack_require__(8166);const upConstructionPoints=async()=>{const msgEl=document.querySelector("body table tbody tr td.msg");if(!msgEl)return;const button=(0,createIconButton_1.createIconButton)({icon:"fa-level-up",iconTitle:"Апнуть таблицу",parentElement:msgEl,showProgress:true,addGap:true,onClick:async()=>{const points=getConstructionPoints();points.forEach((({days,points,cell})=>{const value=points/days;cell.innerHTML=`${points}<br />(${value.toFixed(2)})`}));button.remove()}})};exports.upConstructionPoints=upConstructionPoints;const getConstructionPoints=()=>{const cells=[...document.querySelectorAll("body > form > table > tbody > tr > td")];const result=[];for(let i=0;i<cells.length;i++){const imageCell=cells[i];const titleCell=cells[i+1];const pointsCell=cells[i+2];const isTitleCell=titleCell?.getAttribute("width")==="20%"&&pointsCell?.getAttribute("nowrap")==="true";if(!isTitleCell){continue}const[,title="",days="0"]=/^([\D\s]+)([\d\.]+) .+$/gm.exec(titleCell.textContent??"")??[];const points=parseFloat(pointsCell.textContent?.replace(/\s+/g,"")??"0");result.push({title,days:parseFloat(days),points,cell:pointsCell})}return result}},4390:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upProducePoints=void 0;const createIconButton_1=__webpack_require__(8166);const getJson_1=__webpack_require__(9965);const URL_CALCULATOR="https://bizmania.github.io/data/calculator.json";const upProducePoints=async()=>{const msgEl=document.querySelector("body table tbody tr td.msg");if(!msgEl)return;const button=(0,createIconButton_1.createIconButton)({icon:"fa-level-up",iconTitle:"Апнуть таблицу",parentElement:msgEl,showProgress:true,addGap:true,onClick:async()=>{const data=await(0,getJson_1.getJson)(URL_CALCULATOR);if(!data){return}const points=getProducePoints();const[moscow]=data;const products=moscow.cityProducts.map((cityProduct=>cityProduct.total.produce));points.forEach((({title,points,cell})=>{const product=products.find((product=>product.title===title));if(!product){return}const value=points*product.amount/1e3;cell.innerHTML=`${points}<br />(${value.toFixed(2)})`}));button.remove()}})};exports.upProducePoints=upProducePoints;const getProducePoints=()=>{const cells=[...document.querySelectorAll("body > table:nth-child(5) > tbody > tr > td:nth-child(2) > table > tbody > tr > td")];const result=[];for(let i=1;i<cells.length;i++){const titleCell=cells[i];const pointsCell=cells[i+2];const isTitleCell=titleCell.getAttribute("width")==="20%"&&pointsCell.getAttribute("nowrap")==="true";if(!isTitleCell){continue}const title=titleCell.textContent??"";const points=parseFloat(pointsCell.textContent?.replace(/\s+/g,"")??"0");result.push({title,points,cell:pointsCell})}return result};var CalcSchemeType;(function(CalcSchemeType){CalcSchemeType["Unknown"]="unknown";CalcSchemeType["Field"]="field";CalcSchemeType["Factory"]="factory";CalcSchemeType["Mine"]="mine";CalcSchemeType["Greenhouse"]="greenhouse"})(CalcSchemeType||(CalcSchemeType={}));var EquipmentType;(function(EquipmentType){EquipmentType["Machine"]="machine";EquipmentType["MachineLine"]="machineline";EquipmentType["HeavyEq"]="heavyeq";EquipmentType["MineEq"]="mineeq";EquipmentType["Tractor"]="tractor";EquipmentType["WindGenerator"]="windgenerator";EquipmentType["Cow"]="cow";EquipmentType["Hen"]="hen";EquipmentType["Sheep"]="sheep";EquipmentType["Pig"]="pig";EquipmentType["Sable"]="sable"})(EquipmentType||(EquipmentType={}))},426:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onConstructionPage=void 0;const hideEmptyRequired_1=__webpack_require__(3566);const upSupply_1=__webpack_require__(4466);const onConstructionPage=async()=>{const sp=new URLSearchParams(document.location.search);const constructionId=Number(sp.get("id"));const productId=Number(sp.get("product"));const tab=sp.get("tab")??"unit";switch(tab){case"unit":{break}case"goods":{(0,hideEmptyRequired_1.hideEmptyRequirements)();(0,upSupply_1.upSupply)();break}}};exports.onConstructionPage=onConstructionPage},9574:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(426),exports)},3566:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.hideEmptyRequirements=void 0;const hideEmptyRequirements=async()=>{const cell2=document.querySelector("#content > div.pad12 > form > div:nth-child(1) > table:nth-child(1) > thead > tr:nth-child(1) > td:nth-child(2)");if(!cell2){return}let newLinkEl=document.createElement("a");newLinkEl.textContent=" [hide]";newLinkEl.style.color="#5165a4";newLinkEl.href="#";newLinkEl.id="hideZero";newLinkEl.addEventListener("click",(()=>{const hideEls=document.querySelectorAll("#supplytbl > tbody > tr > td:nth-child(5) > div > span > div");if(!hideEls.length){return false}[...hideEls].forEach((i=>{const value=parseInt(i?.textContent??"0");const closeRowEl=i.closest("tr");const closeValue=parseInt(closeRowEl?.cells?.[9]?.textContent??"0");if((value===0||closeValue>=value)&&closeRowEl){closeRowEl.style.display="none"}}));return false}));cell2.appendChild(newLinkEl)};exports.hideEmptyRequirements=hideEmptyRequirements},4466:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upSupply=void 0;const getConstructionGoods_1=__webpack_require__(4035);const addWikiLink_1=__webpack_require__(4028);const upSupply=async()=>{const goods=await(0,getConstructionGoods_1.getConstructionGoods)();goods.forEach((item=>{const{title,cells:[,,titleCell]}=item;(0,addWikiLink_1.addWikiLink)(title,titleCell)}))};exports.upSupply=upSupply},8258:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onCorporationPage=void 0;const upLoadAllPages_1=__webpack_require__(6843);const upCollectMembers_1=__webpack_require__(7545);const onCorporationPage=async()=>{const sp=new URLSearchParams(document.location.search);const tab=sp.get("tab")??"corporation";(0,upLoadAllPages_1.upLoadAllPages)();switch(tab){case"corporation":{break}case"members":{(0,upCollectMembers_1.upCollectMembers)();break}}};exports.onCorporationPage=onCorporationPage},7263:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(8258),exports)},7545:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upCollectMembers=void 0;const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const upCollectMembers=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const members=await upCollectMembersActions();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(members,null,4))}})};exports.upCollectMembers=upCollectMembers;const upCollectMembersActions=async()=>{const members=Array.from(document.querySelectorAll("table.dataTable tbody a[href*='/profile/']")).map((a=>{const href=a.href;const id=href.split("/profile/")[1];const name=a.textContent?.trim();return{id,name}})).filter((p=>p.id&&p.name));return members}},2994:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onEquipmentPurchasePage=void 0;const loadInfo_1=__webpack_require__(4179);const filters_1=__webpack_require__(3680);const formatNumber_1=__webpack_require__(897);const insertAfter_1=__webpack_require__(4822);const onEquipmentPurchasePage=async()=>{const sp=new URLSearchParams(document.location.search);const divisionId=Number(sp.get("id"));const menu=document.querySelector("body > form > div.nm-tabs");const dataTable=document.querySelector("#vendorstbl.datatable");const te=document.querySelector("form[name=purchaseForm] input[name=type]");const type=parseInt(te?.value??"0");const prodEqInfo=await(0,loadInfo_1.loadInfo)(divisionId);if(!dataTable||!te||!menu||!divisionId||!type||!prodEqInfo){return}{const html=`<div style="display: flex; flex-wrap: nowrap; text-align: right; width: 100%; justify-content: space-between; flex-direction: row; align-items: center; margin: 0 10px">`+`<div>Q работников: <b>${prodEqInfo.QEmp}</b></div>`+`<div>Оборудование: <b>${prodEqInfo.CurrEq} / ${prodEqInfo.MaxEq}</b></div>`+`<button class="q" data-v="${prodEqInfo.QEq}">${prodEqInfo.QEq}${prodEqInfo.QNeed>0?"=>"+prodEqInfo.QNeed:""}</button>`+`</div>`;const dvM=document.createElement("div");menu.appendChild(dvM);dvM.style.display="flex";dvM.style.flex="1 1 auto";dvM.innerHTML=html;const button=dvM.querySelector("button.q");button?.addEventListener("click",(event=>{event.preventDefault();event.stopPropagation();return false}))}{const equipmentAmountMax=prodEqInfo.MaxEq-prodEqInfo.CurrEq;const dataRows=[...dataTable.querySelectorAll("tr")].map((row=>{if(!row.id){return}const{id,cells}=row;const amountCell=cells[6];const qualityCell=cells[8];const priceCell=cells[10];if(!amountCell||!qualityCell||!priceCell){return}const rowAmount=parseInt(amountCell.textContent?.replace(/\s/g,"")??"0");const amount=Math.min(equipmentAmountMax,rowAmount);const quality=parseFloat(qualityCell.textContent??"0");const price=parseFloat(priceCell.textContent?.replace(/\s|p\./g,"")??"0");const currentQualityEquipment=prodEqInfo.QEq*prodEqInfo.CurrEq;const proposedQualityEquipment=quality*amount;const summedQualityEquipment=currentQualityEquipment+proposedQualityEquipment;const summedAmount=amount+prodEqInfo.CurrEq;const deltaQuality=summedQualityEquipment/summedAmount-prodEqInfo.QEq;console.log("deltaQuality",deltaQuality);if(rowAmount!==amount){amountCell.innerHTML=amountCell.innerHTML.replaceAll("&nbsp;","");amountCell.style.whiteSpace="nowrap";const amountSpan=document.createElement("span");amountSpan.style.color="green";amountSpan.textContent=` (${(0,formatNumber_1.formatNumber)(amount.toFixed(0))})`;amountCell.appendChild(amountSpan)}{const span=document.createElement("span");span.style.color=deltaQuality>0?"green":"red";span.textContent=(deltaQuality>0?" +":" ")+deltaQuality.toFixed(3);qualityCell.appendChild(span)}const priceForDeltaQuality=price*amount/deltaQuality;if(!isNaN(priceForDeltaQuality)&&~~(priceForDeltaQuality*1e3)!==0){const priceSpan=document.createElement("span");const value=Math.abs(priceForDeltaQuality);const valueString=(0,formatNumber_1.formatNumber)(value.toFixed(value>100?0:2));priceSpan.innerHTML=`<img src="/img/icons/smallinfo.png" title="${valueString}">`;priceCell.appendChild(priceSpan)}return{id,deltaQuality,priceForDeltaQuality}})).filter(filters_1.notUndefined);const sortedByDeltaQuality=[...dataRows].filter((row=>~~(row.deltaQuality*1e3)>0)).sort(((a,b)=>Math.abs(b.deltaQuality)-Math.abs(a.deltaQuality)));sortedByDeltaQuality.slice(0,3).forEach((({id})=>{const selector=id.replace(/\[/g,"\\[").replace(/\]/g,"\\]");const el=dataTable.querySelector(`tr#${selector} > td:nth-child(9)`);if(el){el.style.backgroundColor="lightgreen"}}));const sortedByDeltaQualityPrice=[...dataRows].filter((row=>~~(row.deltaQuality*1e3)>0)).sort(((a,b)=>Math.abs(a.priceForDeltaQuality)-Math.abs(b.priceForDeltaQuality)));sortedByDeltaQualityPrice.slice(0,3).forEach((({id})=>{const selector=id.replace(/\[/g,"\\[").replace(/\]/g,"\\]");const el=dataTable.querySelector(`tr#${selector} > td:nth-child(11)`);if(el){el.style.backgroundColor="lightgreen"}}))}{const dv=document.createElement("div");const html=`<div style="display: flex;">\n            <div style="display: grid;grid-template-columns: 10% 10% 10%;flex: 1 1 auto;row-gap: 5px;">\n                <span>нужно всего</span>\n                <input id="ca" placeholder="нужное кач-во" type="number" min="0" step="0.01" style="width: 60px; background-color: lightgreen;" value="${prodEqInfo.QNeed}">\n                <input id="qc" placeholder="нужное кол-во" type="number" min="0" step="1"    style="width: 70px; background-color: lightgreen;" value="${prodEqInfo.MaxEq}">\n\n                <span>уже есть</span>\n                <input id="sq" placeholder="есть кач-во" type="number" min="0" step="0.01" style="width: 60px; background-color: lightgreen;" value="${prodEqInfo.QEq}">\n                <input id="sc" placeholder="есть кол-во" type="number" min="0" step="1"    style="width: 70px; background-color: lightgreen;" value="${prodEqInfo.CurrEq}">\n\n                <span>&nbsp;</span>\n                <input id="iq1" placeholder="1-й кач-во" type="number" min="0" step="0.01" style="width: 60px; background-color: white;">\n                <input id="ic1" placeholder="1-й кол-во" type="number" min="0" step="1"    style="width: 70px; background-color: white;">\n\n                <div style="display: flex;flex-direction: row;gap: 10px;grid-column: 1/4;">\n                    <span>надо до требуемого качества</span>\n                    <div><span id="isq">--</span> / <b id="isc">--</b></div>\n                </div>\n\n                <span>&nbsp;</span>\n                <input id="iq2" placeholder="2-й кач-во" type="number" min="0" step="0.01" style="width: 60px; background-color: white;">\n                <input id="ic2" placeholder="2-й кол-во" type="number" min="0" step="1"    style="width: 70px; background-color: white;">\n\n                <div style="display: flex;flex-direction: row;gap: 10px;grid-column: 1/4;">\n                    <div>до результата ещё надо</div>\n                    <div><b id="irq">--</b> / <span id="irc">--</span> =&gt; <b id="irqA">--</b></div>\n                </div>\n            </div>\n        </div>`;dv.innerHTML=html;(0,insertAfter_1.insertAfter)(dv,document.querySelector("form[name=purchaseForm]"));dv.querySelectorAll("input").forEach((nv=>{nv.addEventListener("change",(()=>reCalcQ(dv)))}));reCalcQ(dv)}};exports.onEquipmentPurchasePage=onEquipmentPurchasePage;const reCalcQ=async el=>{const defaultValues=!!sessionStorage.getItem("Calc")?JSON.parse(sessionStorage.getItem("Calc")):undefined;const r0=Number(el.querySelector("#qc").value.replace(/,/gi,".")??0);const rq=Number(el.querySelector("#ca").dataset.value??el.querySelector("#ca").value.replace(/,/gi,"."));const r1=[Number(el.querySelector("#sq").value.replace(/,/gi,".")),Number(el.querySelector("#sc").value)];const r2=[Number(el.querySelector("#iq1").value.replace(/,/gi,".")),Number(el.querySelector("#ic1").value)];const r3=[Number(el.querySelector("#iq2").value.replace(/,/gi,".")),Number(el.querySelector("#ic2").value)];if(!r0&&r0!==defaultValues[0]){el.querySelector("#qc").value=String(defaultValues[0]);return}if(!rq&&rq!==defaultValues[1]){el.querySelector("#ca").value=String(defaultValues[1]);return}if(!r1[0]&&r1[0]!==defaultValues[2][0]){el.querySelector("#sq").value=String(defaultValues[2][0]);el.querySelector("#sc").value=String(defaultValues[2][1]);return}if(!r2[0]&&r2[0]!==defaultValues[3][0]){el.querySelector("#iq1").value=String(defaultValues[3][0]);el.querySelector("#ic1").value=String(defaultValues[3][1]);return}if(!r3[0]&&r3[0]!==defaultValues[4][0]){el.querySelector("#iq2").value=String(defaultValues[4][0]);el.querySelector("#ic2").value=String(defaultValues[4][1]);return}el.querySelector("#isq").textContent=(0,formatNumber_1.formatNumber)(((r1[0]*r1[1]+r2[0]*r2[1]+r3[0]*r3[1])/(r1[1]+r2[1]+r3[1])).toFixed(2));el.querySelector("#isc").textContent=(0,formatNumber_1.formatNumber)(((rq*(r1[1]+r3[1])-r1[0]*r1[1]-r3[0]*r3[1])/(r2[0]-rq)).toFixed(2));let irc=r0-(r1[1]+r2[1]+r3[1])>0?r0-(r1[1]+r2[1]+r3[1]):0,irq=(rq*r0-r1[0]*r1[1]-r2[0]*r2[1]-r3[0]*r3[1])/irc;el.querySelector("#irq").textContent=isNaN(irq)?"--":irq>=0&&isFinite(irq)?(0,formatNumber_1.formatNumber)(irq.toFixed(2)):" такое не реально ";el.querySelector("#irc").textContent=irc>=0?String(irc):" хотите купить больше, чем возможно ";el.querySelector("#irqA").textContent=(isNaN((r1[0]*r1[1]+r2[0]*r2[1]+r3[0]*r3[1]+irc*(isNaN(irq)?0:irq))/(r1[1]+r2[1]+r3[1]+irc))?"--":(0,formatNumber_1.formatNumber)(((r1[0]*r1[1]+r2[0]*r2[1]+r3[0]*r3[1]+irc*(isNaN(irq)?0:irq))/(r1[1]+r2[1]+r3[1]+irc)).toFixed(2)))+" // "+(0,formatNumber_1.formatNumber)(((r1[0]*r1[1]+r2[0]*r2[1]+r3[0]*r3[1])/(r1[1]+r2[1]+r3[1])).toFixed(2));sessionStorage.setItem("Calc",JSON.stringify([r0,rq,r1,r2,r3]))}},3477:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(2994),exports)},1146:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onFactoryPage=void 0;const getQbase_1=__webpack_require__(1892);const upProductionSale_1=__webpack_require__(9894);const fillInfo_1=__webpack_require__(6400);const upDivisions_1=__webpack_require__(6046);const onFactoryPage=async()=>{const sp=new URLSearchParams(document.location.search);const factoryId=Number(sp.get("id"));const tab=sp.get("tab")??"factory";const stab=sp.get("stab")??"sales";switch(tab){case"factory":{(0,upDivisions_1.upDivisions)();break}case"divisions":{(0,fillInfo_1.fillInfo)();break}case"goods":switch(stab){case"sales":{(0,upProductionSale_1.upProductionSale)();(0,getQbase_1.loadQBase)(factoryId);break}}break}};exports.onFactoryPage=onFactoryPage},4371:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(1146),exports)},6400:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.fillInfo=void 0;const saveInfo_1=__webpack_require__(986);const fillInfo=async()=>{const sp=new URLSearchParams(document.location.search);const divisionId=Number(sp.get("division"));if(!divisionId){return}const Elinfo=document.querySelector("#boxright");if(!Elinfo){return}(0,saveInfo_1.saveInfo)({Elinfo,QEmpSel:"form > div > table.datatable > tbody > tr:nth-child(2) > td:nth-child(6)",CurrEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(4)",MaxEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(5)",QEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(7)",QNeedSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(9)"})};exports.fillInfo=fillInfo},6046:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upDivisions=void 0;const getUnitDivisions_1=__webpack_require__(8796);const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const upDivisions=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const members=await upDivisionsAction();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(members,null,4))}})};exports.upDivisions=upDivisions;const upDivisionsAction=async()=>(0,getUnitDivisions_1.getUnitDivisions)()},9468:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onFishfarmPage=void 0;const qualityInput_1=__webpack_require__(9304);const onFishfarmPage=async()=>{const sp=new URLSearchParams(document.location.search);const fishfarmId=Number(sp.get("id"));const tab=sp.get("tab")??"fishfarm";switch(tab){case"fishfarm":{break}case"goods":{(0,qualityInput_1.upgradeQualityInput)();break}}};exports.onFishfarmPage=onFishfarmPage},3901:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(9468),exports)},9818:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onGreenhousePage=void 0;const upProductionSale_1=__webpack_require__(9894);const onGreenhousePage=async()=>{const sp=new URLSearchParams(document.location.search);const greenhouseId=Number(sp.get("id"));const tab=sp.get("tab")??"greenhouse";const stab=sp.get("stab")??"sales";switch(tab){case"greenhouse":{break}case"divisions":{break}case"goods":switch(stab){case"sales":{(0,upProductionSale_1.upProductionSale)();break}}break}};exports.onGreenhousePage=onGreenhousePage},5786:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(9818),exports)},3826:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(5193),exports);__exportStar(__webpack_require__(8551),exports);__exportStar(__webpack_require__(8739),exports);__exportStar(__webpack_require__(6164),exports);__exportStar(__webpack_require__(758),exports);__exportStar(__webpack_require__(9574),exports);__exportStar(__webpack_require__(7263),exports);__exportStar(__webpack_require__(3477),exports);__exportStar(__webpack_require__(5786),exports);__exportStar(__webpack_require__(4371),exports);__exportStar(__webpack_require__(3901),exports);__exportStar(__webpack_require__(7336),exports);__exportStar(__webpack_require__(7510),exports);__exportStar(__webpack_require__(7791),exports);__exportStar(__webpack_require__(3582),exports);__exportStar(__webpack_require__(472),exports);__exportStar(__webpack_require__(3827),exports);__exportStar(__webpack_require__(9565),exports);__exportStar(__webpack_require__(6818),exports)},7336:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(6602),exports)},6602:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onMinePage=void 0;const upProductionSale_1=__webpack_require__(9894);const qualityInput_1=__webpack_require__(9304);const fillInfo_1=__webpack_require__(2523);const onMinePage=async()=>{const sp=new URLSearchParams(document.location.search);const mineId=Number(sp.get("id"));const tab=sp.get("tab")??"mine";switch(tab){case"mine":{break}case"divisions":{(0,fillInfo_1.fillInfo)();break}case"goods":{(0,qualityInput_1.upgradeQualityInput)();(0,upProductionSale_1.upProductionSale)();break}}};exports.onMinePage=onMinePage},2523:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.fillInfo=void 0;const saveInfo_1=__webpack_require__(986);const fillInfo=async()=>{const sp=new URLSearchParams(document.location.search);const divisionId=Number(sp.get("division"));if(!divisionId){return}const Elinfo=document.querySelector("#boxright");if(!Elinfo){return}(0,saveInfo_1.saveInfo)({Elinfo,QEmpSel:"form > div > table.datatable > tbody > tr:nth-child(2) > td:nth-child(6)",CurrEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(4)",MaxEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(5)",QEqSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(7)",QNeedSel:"form > div > table.datatable > tbody > tr:nth-child(4) > td:nth-child(9)"})};exports.fillInfo=fillInfo},7510:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(7642),exports)},7642:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onSawmillPage=void 0;const upProductionSale_1=__webpack_require__(9894);const qualityInput_1=__webpack_require__(9304);const onSawmillPage=async()=>{const sp=new URLSearchParams(document.location.search);const sawmillId=Number(sp.get("id"));const productId=Number(sp.get("product"));const tab=sp.get("tab")??"sawmill";const stab=sp.get("stab")??"sales";switch(tab){case"sawmill":{break}case"goods":{if(!productId){(0,qualityInput_1.upgradeQualityInput)()}else switch(stab){case"sales":{(0,upProductionSale_1.upProductionSale)();break}}break}}};exports.onSawmillPage=onSawmillPage},7791:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(2780),exports)},2780:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onShopPage=void 0;const markUniqGoods_1=__webpack_require__(2499);const showGoodsProfit_1=__webpack_require__(9682);const upBuildingInfo_1=__webpack_require__(2200);const onShopPage=async()=>{const sp=new URLSearchParams(document.location.search);const shopId=Number(sp.get("id"));const tab=sp.get("tab")??"shop";const divisionId=Number(sp.get("division"));switch(tab){case"shop":{break}case"goods":{(0,showGoodsProfit_1.showGoodsProfit)();break}case"divisions":{if(!divisionId){(0,markUniqGoods_1.markUniqGoods)()}else{(0,upBuildingInfo_1.upBuildingInfo)()}break}}};exports.onShopPage=onShopPage},2499:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.markUniqGoods=void 0;const markUniqGoods=()=>{const imageEls=document.querySelectorAll("#content > div.pad12 > form > table.goods > tbody > tr > td.int.hidecompact > a > img");if(!imageEls.length){return}const stI={};imageEls.forEach((({src})=>{stI[src]=1+(stI[src]??0)}));imageEls.forEach((image=>{if(stI[image.src]==1){image.border="2"}}))};exports.markUniqGoods=markUniqGoods},9682:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.showGoodsProfit=void 0;const getStoreGoods_1=__webpack_require__(8153);const addWikiLink_1=__webpack_require__(4028);const showGoodsProfit=()=>{(0,getStoreGoods_1.getStoreGoods)().forEach((item=>{const[,titleCell]=item.cells;(0,addWikiLink_1.addWikiLink)(item.title,titleCell);showCityBasedDeviation(item);switch(item.type){case getStoreGoods_1.StoreGoodsType.Closed:{break}case getStoreGoods_1.StoreGoodsType.Opened:{break}}}))};exports.showGoodsProfit=showGoodsProfit;const showCityBasedDeviation=goods=>{const{quality,price,cityQuality,cityPrice}=goods;const priceValue=goods.type===getStoreGoods_1.StoreGoodsType.Closed?price.value:goods.sellPrice.value;const priceQuality=priceValue/quality.value;const cityPriceQuality=cityPrice.value/cityQuality.value;const ratio=priceQuality/cityPriceQuality;const deviation=(ratio-1)*100;if(isNaN(deviation)||!isFinite(deviation)||deviation===0){return}const recTxt=document.createElement("span");recTxt.textContent=`${deviation>0?"+":""}${deviation.toFixed(2)} %`;recTxt.title="Отклонение от Средней в городе (с учетом качества)";recTxt.style.backgroundColor=deviation<0?"lightpink":deviation>0?"lightgreen":"";price.cell.appendChild(recTxt)}},2200:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upBuildingInfo=void 0;const upBuildingInfo=async()=>{const buildingRowEl=document.querySelector("#boxright > div:nth-child(3) > div:nth-child(1) > table > tbody > tr > td:nth-child(2) > table > tbody > tr:nth-child(1)");if(!buildingRowEl){return}const buildingLinkEl=buildingRowEl.querySelector("a");if(!buildingLinkEl){return}const buildingId=buildingLinkEl.href.match(/buildingId=(\d+)/)?.[1];if(!buildingId){return}const newRowEl=document.createElement("tr");newRowEl.innerHTML=`\n        <td>Дом</td>\n        <td>\n            ${buildingId}\n            &nbsp;\n            <a href="javascript:dialog('/city/object/?id=${buildingId}')">👀</a>\n        </td>\n    `;buildingRowEl.after(newRowEl)};exports.upBuildingInfo=upBuildingInfo},2186:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upgradeMassVendorsTable=void 0;const formatNumber_1=__webpack_require__(897);const upgradeMassVendorsTable=async()=>{const vendorsTable=document.querySelector("#vendorstbl");if(!vendorsTable){return}addFooterInfo(vendorsTable);const Price=vendorsTable.querySelector("tbody >tr > td:last-child").cellIndex-1;{const Ck=0;const priceCells=vendorsTable.querySelectorAll("tbody > tr > td:nth-child("+Price+")");priceCells.forEach((function(cell,rowIndex){const b=document.createElement("b");cell.appendChild(b);const c=calcK(vendorsTable,cell,rowIndex);if(Ck){b.style.color=c<=Ck?"green":"red"}b.textContent=" "+(0,formatNumber_1.formatMoney)(c.toFixed(c>100?0:2))}))}};exports.upgradeMassVendorsTable=upgradeMassVendorsTable;const addFooterInfo=dd=>{const dd2=dd.querySelector("tfoot > tr > td:nth-child(4)");if(!dd2){return}if(dd2.textContent==="Среднее по городу:"){const dd3=dd.querySelector("tfoot > tr > td:nth-child(8)")?dd.querySelector("tfoot > tr > td:nth-child(8)"):dd.querySelector("tfoot > tr > td:nth-child(6)");if(dd3){const C1=parseFloat(dd3.textContent?.replace(/(p\.|\s)+/g,"")??"");const C2=parseFloat(dd.querySelector("tfoot > tr > td:nth-child(5)")?.textContent??"");const Ck=C1/C2;dd3.textContent+=" "+(0,formatNumber_1.formatMoney)(Ck.toFixed(Ck>100?0:2))}}};const calcK=(vendorsTable,priceCell,rowIndex)=>{const price=parseFloat(priceCell.textContent?.replace(/(p\.|\s)+/g,"")??"1");const qualityCell=vendorsTable.querySelector(`tbody > tr:nth-child(${rowIndex+1}) > td:nth-child(7)`);const quality=parseFloat(qualityCell?.textContent??"1");return price/quality}},3258:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upgradeVendorsTable=void 0;const formatNumber_1=__webpack_require__(897);const upgradeVendorsTable=async()=>{const vendorsTable=document.querySelector("#vendorstbl");if(!vendorsTable){return}addFooterInfo(vendorsTable);const Price=vendorsTable.querySelector("tbody >tr > td:last-child").cellIndex+1;const mark="price";const Ck=0;if(mark==="price"){const priceCells=vendorsTable.querySelectorAll("tbody > tr > td:nth-child("+Price+")");priceCells.forEach((function(priceCell,rowIndex){const b=document.createElement("b");priceCell.appendChild(b);const c=calcK(vendorsTable,priceCell,rowIndex);if(Ck){b.style.color=c<=Ck?"green":"red"}b.textContent=" "+(0,formatNumber_1.formatMoney)(c.toFixed(c>100?0:2))}))}};exports.upgradeVendorsTable=upgradeVendorsTable;const addFooterInfo=dd=>{const dd2=dd.querySelector("tfoot > tr > td:nth-child(4)");if(!dd2){return}if(dd2.textContent==="Среднее по городу:"){const dd3=dd.querySelector("tfoot > tr > td:nth-child(8)")?dd.querySelector("tfoot > tr > td:nth-child(8)"):dd.querySelector("tfoot > tr > td:nth-child(6)");if(dd3){const C1=parseFloat(dd3.textContent?.replace(/(p\.|\s)+/g,"")??"");const C2=parseFloat(dd.querySelector("tfoot > tr > td:nth-child(5)")?.textContent??"");const Ck=C1/C2;dd3.textContent+=" "+(0,formatNumber_1.formatMoney)(Ck.toFixed(Ck>100?0:2))}}};const calcK=(vendorsTable,priceCell,rowIndex)=>{const price=parseFloat(priceCell.textContent?.replace(/(p\.|\s)+/g,"")??"1");const qualityCell=vendorsTable.querySelector(`tbody > tr:nth-child(${rowIndex+1}) > td:nth-child(9)`);const quality=parseFloat(qualityCell?.textContent??"1");return price/quality}},3827:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onVendorSelectPage=void 0;const massVendorsTable_1=__webpack_require__(2186);const vendorsTable_1=__webpack_require__(3258);const onVendorSelectPage=async()=>{const sp=new URLSearchParams(document.location.search);const buildingId=parseInt(sp.get("id"));const productId=parseInt(sp.get("product"));const scene=sp.get("$scene")??"vendor";if(!buildingId||!productId){return}switch(scene){case"vendor":{(0,vendorsTable_1.upgradeVendorsTable)();break}case"massvendors":{(0,massVendorsTable_1.upgradeMassVendorsTable)()}}};exports.onVendorSelectPage=onVendorSelectPage},3582:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(3634),exports)},3634:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onWarehousePage=void 0;const upProductionSale_1=__webpack_require__(9894);const onWarehousePage=async()=>{const sp=new URLSearchParams(document.location.search);const warehouseId=Number(sp.get("id"));const tab=sp.get("tab")??"warehouse";switch(tab){case"warehouse":{break}case"goods":{(0,upProductionSale_1.upProductionSale)(true);break}case"supply":{break}}};exports.onWarehousePage=onWarehousePage},9565:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onWeeklyPacksPage=void 0;const onWeeklyPacksPage=async()=>{const qualificationEl=document.querySelectorAll("#content > div.tabbody > div > form > table > tbody > tr > td > div > table > tbody > tr:nth-child(3) > td > b");const priceEl=document.querySelectorAll("#content > div.tabbody > div > form > table > tbody > tr > td > div > table > tbody > tr:nth-child(4) > td > div > a > span");[...priceEl].forEach((function(i,ind){const points=Number(qualificationEl[ind].textContent);const price=parseFloat(i.textContent?.replace(/[^\d]/g,"")??"0");const pointsPrice=Math.round(price*100/points)/100;const suffix=i.textContent?.replace(/\d/g,"")??"";qualificationEl[ind].textContent+=` (${pointsPrice}${suffix})`}))};exports.onWeeklyPacksPage=onWeeklyPacksPage},472:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(__webpack_require__(6678),exports)},4843:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upDivisionPairsAction=exports.upDivisionPairs=void 0;const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const upDivisionPairs=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const pairs=await(0,exports.upDivisionPairsAction)();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(pairs,null,4))}})};exports.upDivisionPairs=upDivisionPairs;const upDivisionPairsAction=async frame=>{const doc=frame??document;const table=doc.querySelector("#content table.datatable");if(!table)return;return[...table.querySelectorAll(":scope > tbody > tr")].map((tr=>{const[imageCell,titleCell]=tr.querySelectorAll("td");const image=imageCell.querySelector("img")?.src.split("img=").pop()??"";const anchor=titleCell.querySelector("a");const title=anchor?.textContent?.trim()??"";const name=anchor?.href.split("division=")[1]??"";return{image,name,title}}))};exports.upDivisionPairsAction=upDivisionPairsAction},79:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upProductPairsAction=exports.upProductPairs=void 0;const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const upProductPairs=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const pairs=await(0,exports.upProductPairsAction)();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(pairs,null,4))}})};exports.upProductPairs=upProductPairs;const upProductPairsAction=async(doc=document)=>{const pairs=Array.from(doc.querySelectorAll("table.wikihelp tr td table a[href*='/wikihelp/?topic=']")).map((a=>{const href=a.href;const name=href.split("product=")[1];const title=a.textContent?.trim();return{name,title}})).filter((p=>p.name&&p.title)).reduce(((acc,p)=>{acc[p.name]=p.title;return acc}),{});return pairs};exports.upProductPairsAction=upProductPairsAction},868:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upUnitPairsAction=exports.upUnitPairs=void 0;const copyToClipboard_1=__webpack_require__(6865);const createIconButton_1=__webpack_require__(8166);const getHtml_1=__webpack_require__(2326);const upDivisionPairs_1=__webpack_require__(4843);const upUnitPairs=async()=>{const h1=document.querySelector("h1");if(!h1)return;(0,createIconButton_1.createIconButton)({icon:"fa-clipboard",iconTitle:"В буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const pairs=await(0,exports.upUnitPairsAction)();(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(pairs,null,4))}});(0,createIconButton_1.createIconButton)({icon:"fa-download",iconTitle:"Скачать в буфер",parentElement:h1,showProgress:true,addGap:true,onClick:async()=>{const pairs=await(0,exports.upUnitPairsAction)(true);(0,copyToClipboard_1.copyToClipboard)(JSON.stringify(pairs,null,4))}})};exports.upUnitPairs=upUnitPairs;const upUnitPairsAction=async(download=false)=>{const links=[...document.querySelectorAll("#content > table > tbody > tr > td > div > table > tbody > tr > td table > tbody > tr > td > a")];const promises=links.map((async a=>{const link=a.href??"";const name=link.split("unit=")[1];const title=a.textContent?.trim()??"";const divisions=download?await(0,upDivisionPairs_1.upDivisionPairsAction)(await(0,getHtml_1.getHtml)(link))??[]:[];return{name,title,link,divisions}}));return Promise.all(promises)};exports.upUnitPairsAction=upUnitPairsAction},6678:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.onWikiHelpPage=void 0;const upDivisionPairs_1=__webpack_require__(4843);const upProductPairs_1=__webpack_require__(79);const upUnitPairs_1=__webpack_require__(868);const onWikiHelpPage=async()=>{const dlp=document.location.pathname;const sp=new URLSearchParams(document.location.search);const[,topicSrc]=dlp.split("/wikihelp/topic/");const topic=sp.get("topic")??decodeURI(topicSrc);switch(topic){case"Справочник продуктов":{const product=sp.get("product");if(!product){(0,upProductPairs_1.upProductPairs)()}break}case"Виды предприятий":{const unit=sp.get("unit");if(!unit){(0,upUnitPairs_1.upUnitPairs)()}else{(0,upDivisionPairs_1.upDivisionPairs)()}break}}};exports.onWikiHelpPage=onWikiHelpPage},3697:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getCompany=void 0;const getHtml_1=__webpack_require__(2326);const getCompany=async url=>{const doc=url?await(0,getHtml_1.getHtml)(url):document;if(!doc){return}const companyOpen="#content > table:nth-child(4) > tbody > tr:nth-child(2) > td:nth-child(2) > table";const companyClose="#content > table:nth-child(4) > tbody > tr:nth-child(1) > td:nth-child(1) > table";const citiesEl=doc.querySelector(companyOpen)??doc.querySelector(companyClose);const cities=parseCompanyCities(citiesEl);console.log(cities);const info={cities};return info};exports.getCompany=getCompany;const parseCompanyCities=tableEl=>{if(!tableEl){return[]}const cities=[];const rows=tableEl.querySelectorAll("tr");for(let i=0;i<rows.length;i+=2){const cityRow=rows[i];const unitsRow=rows[i+1];const city=parseCity(cityRow);city.units=parseCityUnits(unitsRow);cities.push(city)}return cities};const parseCity=row=>{const[countryCell,cityCell]=row.querySelectorAll("td");const countryLink=countryCell.querySelector("a");const countryImage=countryLink?.querySelector("img");const countryId=Number(countryLink?.href?.split("=")[1]);const countryName=countryImage?.src.split("/").pop()?.split(".gif")[0]??"";const countryTitle=countryImage?.title??"";const cityLink=cityCell.querySelector("a");const cityId=Number(cityLink?.href?.split("=")[1]);const cityTitle=cityLink?.textContent??"";return{id:cityId,title:cityTitle,country:{id:countryId,name:countryName,title:countryTitle},units:[]}};const parseCityUnits=row=>{const unitEls=row.querySelectorAll(".unitlist > span");return[...unitEls].map((unitEl=>{const tooltipEl=unitEl.querySelector(".tooltip");const hint=tooltipEl?.getAttribute("hint")??"";const[title,levelSource]=hint.split("     ").map((s=>s.trim()));const levels=levelSource.split(":")[1];const[level,levelUps=0]=levels.split("+").map(Number);const unitLink=unitEl.querySelector("a");const url=unitLink?.href??"";const id=Number(url.split("=")[1]);const unitImage=unitEl.querySelector("img");const name=unitImage?.src.split("/").pop()?.split(".gif")[0]??"";return{id,name,title,url,level,levelUps,divisions:[]}}))}},4035:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getConstructionGoods=void 0;const getConstructionGoods=async()=>[...document.querySelectorAll("#supplytbl tbody tr")].map((tr=>({row:tr,cells:[...tr.querySelectorAll("td")]}))).map((({row,cells})=>{const[,imageCell,titleCell]=cells;const hiddenEl=imageCell.querySelector("input[type=hidden]");const id=Number(hiddenEl?.value??0);const imageEl=imageCell.querySelector("img");const icon=imageEl?.src??"";const name=icon.split("/").pop()?.split(".gif")[0]??"";const titleLink=titleCell.querySelector("a");const title=titleLink?.textContent??"";return{id,name,title,icon,row,cells}}));exports.getConstructionGoods=getConstructionGoods},8591:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getMyCompany=void 0;const getMyCompany=async()=>{const mainScript=document.querySelectorAll("#divmenu.menucontainer script")[1]?.textContent??"";const companyId=parseInt(mainScript.match(/company\?id=(\d+)/)?.[1]??"0")??0;const citySrc=document.querySelector("table.unith tbody")?.rows?.[1]?.cells?.[4]?.querySelectorAll("a")?.[1]?.href?.split("=")?.[1]??"0";const cityId=parseInt(citySrc)??0;return{companyId,cityId}};exports.getMyCompany=getMyCompany},1117:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getOptVendors=exports.getOptPriceQuality=void 0;const getHtml_1=__webpack_require__(2326);const getMyCompany_1=__webpack_require__(8591);const getOptPriceQuality=async args=>{const doc=await getOptDoc(args);if(!doc){return}const R=doc.querySelector("td#boxright.boxright table.datatable tbody");if(!R||R.rows[0].cells[0].classList.contains("tblempty")){return}const{companyId}=await(0,getMyCompany_1.getMyCompany)();const firstNotMyRow=[...R.rows].find((row=>{const hrf=row.cells[2].querySelector("a");const sP=hrf?parseInt(hrf.href.split("=").slice(-1)[0]):-1;return sP!==companyId}));if(!firstNotMyRow){return}const qualityCell=firstNotMyRow.cells[6];const quality=parseFloat(qualityCell.innerText.replace(/\s+|p/gi,""));const priceCell=firstNotMyRow.cells[11];const price=parseFloat(priceCell.innerText.replace(/\s+|p/gi,""));return price/quality};exports.getOptPriceQuality=getOptPriceQuality;const getOptVendors=async args=>{const doc=await getOptDoc(args);if(!doc){return[]}const tbodyEl=doc.querySelector("td#boxright.boxright table.datatable tbody");if(!tbodyEl||!tbodyEl.rows[0].cells.length){return[]}const{companyId}=await(0,getMyCompany_1.getMyCompany)();const returnValue=[...tbodyEl.rows].map((({cells})=>{const nmCell=cells[2];const nm=nmCell.innerText;const linkSp=nmCell.querySelector("a");const sP=linkSp?parseInt(linkSp.href.split("=").slice(-1)[0]):0;const linkSpv=cells[1].querySelector("a");const sPv=linkSpv?parseInt(linkSpv.href.split("=").slice(-1)[0]):0;const addr=cells[4].innerText;const stock=parseFloat(cells[5].innerText.replace(/\s+/gi,""));const quality=parseFloat(cells[6].innerText.replace(/\s+/gi,""));const days=parseFloat(cells[9].innerText.replace(/[^\d]/gi,""));const deliver=parseFloat(cells[8].innerText.replace(/\s+|p/gi,""));const customs=parseFloat(cells[10].innerText.replace(/\s+|p/gi,""));const price=parseFloat(cells[11].innerText.replace(/\s+|p/gi,""));return{isMine:sP==companyId,companyTitle:nm,cityTitle:addr,amount:stock,totalPrice:price,quality,priceQuality:price/quality,buildingId:sPv,deliveryDays:days-(deliver==0?1:0),deliveryPrice:deliver,customs}}));if(!args.allPages){return returnValue}const scriptText=doc.querySelector(".tblpages > script")?.text??"";const mPage=parseInt(/createPGNavigator\("vendors","vendorsfrm","p",1,(\d+),/g.exec(scriptText)?.[1]??"1");if(mPage===1){return returnValue}const promises=[];for(let p=2;p<=mPage;p++){promises.push((0,exports.getOptVendors)({...args,page:p,allPages:false}))}const pages=await Promise.all(promises);return returnValue.concat(...pages.flat())};exports.getOptVendors=getOptVendors;const getOptDoc=async({productId:id,cityId:city,cityOffer:CityOffer,sortOrder,page=1})=>{const url=`https://bizmania.ru/analitics/vendors/?product=${id}&type=vendor&city=${city}`+(sortOrder!==""?`&sort=${sortOrder}`:"")+(page!=1?`&p=${page}`:"")+(CityOffer?"&cityOffersOnly=on":"");return(0,getHtml_1.getHtml)(url)}},1892:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.loadQBase=exports.getQBase=void 0;const getHtml_1=__webpack_require__(2326);const getQBase=factoryId=>{const data=sessionStorage.getItem(`P${factoryId}d`);if(data){return JSON.parse(data)}return(0,exports.loadQBase)(factoryId)};exports.getQBase=getQBase;const loadQBase=async(factoryId,download=false)=>{const dlp=document.location.pathname;const searchParams=new URLSearchParams(document.location.search);const isLocal="/units/factory/"===dlp&&searchParams.get("tab")==="goods"&&!searchParams.get("product");if(!isLocal&&!download){return}const s1=isLocal?document:await(0,getHtml_1.getHtml)(`https://bizmania.ru/units/factory/?id=${factoryId}&tab=goods`);if(!s1){return}const schemes={};const goods={};const urls=["https://bizmania.ru/img/sprite/","https://bizmania.ru/img/products/"];const divisionRows=[...s1.querySelectorAll("#produce > tbody > tr")];const divisions=divisionRows.map((el=>({img:el.cells[0]?.querySelector("img")?.src.split("/").pop()??"",title:el.cells[1]?.querySelector("a")?.textContent??"",divisionId:Number(el.cells[11]?.querySelector("a")?.href.match(/id=(\d+)/)?.[1])})));const fractionToNumber=v=>{const vv=v.split("/");return vv&&vv.length==2?parseFloat(vv[0])/parseFloat(vv[1]):parseFloat(v)};const promises=divisions.map((async({divisionId})=>{const schemeDialogFrame=await(0,getHtml_1.getHtml)(`https://bizmania.ru/units/produce/scheme/?id=${divisionId}`);if(!schemeDialogFrame){return}const schemeRows=[...schemeDialogFrame.querySelectorAll("form[name=schemeForm] > table.datatable > tbody > tr")];schemes[divisionId]=schemeRows.map((({cells})=>{const[imageCell,titleCell,produceCell,consumeCell,sourceCell]=cells;const image=imageCell.querySelector("img")?.src??"";const title=titleCell.textContent??"";const produce=parseFloat(produceCell?.textContent??"0");const consume=parseFloat(consumeCell?.textContent??"0");goods[title]=image.split("/").pop()??"";const sources=[];const dc=sourceCell.querySelectorAll("table tr")[0].cells;for(let i=0;i<dc.length;i=i+2){const sourceProductCell=dc[i];const sourceAmountCell=dc[i+1];const sourceProductImage=sourceProductCell.querySelector("img");const sourceTitle=sourceProductImage?.title??"";goods[sourceTitle]=sourceProductImage?.src.split("/").pop()??"";sources.push({title:sourceTitle,qualityPart:parseInt(sourceProductCell.textContent?.replace(/%/gi,"")??"0"),amount:fractionToNumber(sourceAmountCell.textContent?.replace(/x /gi,"")??"0")})}return{title,produce,consume,sources}}))}));await Promise.all(promises);const value={data:schemes,goods,prod:divisions,urls};sessionStorage.setItem(`P${factoryId}d`,JSON.stringify(value));return value};exports.loadQBase=loadQBase},8153:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getStoreGoods=exports.StoreGoodsType=void 0;const filters_1=__webpack_require__(3680);var StoreGoodsType;(function(StoreGoodsType){StoreGoodsType["Closed"]="Closed";StoreGoodsType["Opened"]="Opened";StoreGoodsType["Mine"]="Mine"})(StoreGoodsType||(exports.StoreGoodsType=StoreGoodsType={}));const getStoreGoods=()=>[...document.querySelectorAll("#goods tr[id^=pr]")].map((tr=>({id:Number(tr.getAttribute("id")?.replace(/pr/g,"")),row:tr,cells:[...tr.querySelectorAll("td")]}))).map((({id,row,cells})=>{if(!id||id<=0||isNaN(id)){return}const[imageCell]=cells;const imageEl=imageCell.querySelector("img");const icon=imageEl?.src??"";const name=icon.split("/").pop()?.split(".gif")[0]??"";const title=imageEl?.title??"";const base={id,name,title,icon,row,cells};switch(cells.length){case 6:{const plainNumberCells=[2,3,4,5];const[quality,price,cityQuality,cityPrice]=plainNumberCells.map((i=>({value:parseFloat(cells[i]?.textContent?.replace(/(p\.|\s)+/g,"")??""),cell:cells[i]})));return{...base,type:StoreGoodsType.Closed,quality,price,cityQuality,cityPrice}}case 16:{const plainNumberCells=[5,6,7,10,11,12];const[amount,quality,price,cityQuality,cityPrice,sellAmount]=plainNumberCells.map((i=>({value:parseFloat(cells[i]?.textContent?.replace(/(p\.|\s)+/g,"")??""),cell:cells[i]})));const inputNumberCells=[9,14];const isMine=!!cells[inputNumberCells[0]]?.querySelector("input.edit");const[sellPrice,buyAmount]=inputNumberCells.map((i=>({value:parseFloat((isMine?cells[i]?.querySelector("input.edit")?.value:cells[i]?.textContent)?.replace(/(p\.|\s)+/g,"")??""),cell:cells[i]})));return{...base,type:isMine?StoreGoodsType.Mine:StoreGoodsType.Opened,amount,quality,price,sellPrice,cityQuality,cityPrice,sellAmount,buyAmount}}default:return}})).filter(filters_1.notUndefined);exports.getStoreGoods=getStoreGoods},8796:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getUnitDivisions=void 0;const filters_1=__webpack_require__(3680);const getHtml_1=__webpack_require__(2326);const wikiUnits_1=__webpack_require__(8455);const getUnitDivisions=async url=>{const doc=url?await(0,getHtml_1.getHtml)(url):document;if(!doc){return}const script=[...doc.querySelectorAll("#content script")].filter((script=>script.textContent?.includes("unitMapData"))).map((script=>script.textContent))[0];if(!script){return}const code=/var unitMapData=(\{.+\]\});/gs.exec(script)?.[1]??"{}";const fixedCode=code.replace(/'(\/img\/sprite\/img\/\w+)\:(\w+)'/g,'"$1!$2"').replace(/(?:['"])?([a-z0-9A-Z_]+)(?:['"])?:/g,'"$1": ').replace(/:\s*?(?:'([^']*)')/g,': "$1"').replace(/\s*"[^"]*":\s*[^(,[\]{}]*\([^()]*(?:\([^()]*\)[^()]*)*\)\s*,?/g,"");const unitMapData=JSON.parse(fixedCode);unitMapData.divisions=unitMapData.divisions.map((division=>{division.img=division.img.replace(/!(\w+)/,":$1");return division}));const unitDivisions=unitMapData.divisions.map((division=>{const image=division.img.split("/").pop()??"";const wikiDivision=wikiUnits_1.WIKI_DIVISIONS_IMAGE_MAP.get(image);if(!wikiDivision){return}return{id:division.id,name:wikiDivision.title,title:division.name,code:wikiDivision.name,image,level:division.level,freeLevels:division.freeLevels}})).filter(filters_1.notUndefined);return unitDivisions};exports.getUnitDivisions=getUnitDivisions},9438:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.PRODUCTS_TITLE_NAME=exports.PRODUCTS_NAME_TITLE=void 0;exports.PRODUCTS_NAME_TITLE={car:"Автомобиль",batterypack:"Аккумулятор",accessories:"Аксессуары",jack:"Домкрат",quadbike:"Квадроцикл",compressor:"Компрессор",bodyparts:"Кузовные детали",machineoil:"Машинное масло",moto:"Мотоцикл",washerfluid:"Омывающая жидкость",subwoofer:"Сабвуфер",scooter:"Скутер",tire:"Шины",electriccar:"Электромобиль",childshoes:"Детская обувь",childclothes:"Детская одежда",toys:"Мягкая игрушка",constructor:"Конструктор",babyfood:"Детская смесь",diapers:"Подгузники",stroller:"Коляска",books:"Детские книги",stationery:"Канцтовары",doll:"Кукла",transformer:"Трансформер",boardgames:"Настольные игры",exercisebook:"Тетрадь",furniture:"Мебель для детей",bottle:"Бутылочка",blouse:"Блузка",jeans:"Джинсы",womanshoes:"Туфли",suit:"Костюм",jacket:"Куртка",manshoes:"Ботинки",socks:"Носки",mancoat:"Пальто",gloves:"Перчатки",dress:"Платье",belt:"Ремень",shirt:"Рубашка",tshirt:"Футболка",cap:"Шапка",furcoat:"Шуба",scarf:"Шарф",skirt:"Юбка",shorts:"Шорты",downjacket:"Пуховик",sweatshirt:"Толстовка",boots:"Сапоги",slates:"Сланцы",sheepskin:"Дубленка",sweater:"Свитер",tie:"Галстук",underwear:"Белье",bijouterie:"Бижутерия",razor:"Бритва",watches:"Золотые часы",tights:"Колготки",makeup:"Косметика",parfume:"Парфюмерия",souvenir:"Сувенир",hairdryer:"Фен",flowers:"Цветы",epilator:"Эпилятор",jewelry:"Ювелирные украшения",aroma:"Арома-палочки",massager:"Массажер",bag:"Сумка",wine:"Вино",yogurt:"Йогурт",sausages:"Колбаса",vodka:"Крепкий алкоголь",croup:"Крупа",macaron:"Макаронные изделия",butter:"Масло",flour:"Мука",cookies:"Печенье",beer:"Пиво",gaswater:"Прохладительные напитки",fat:"Растительное масло",sugar:"Сахар",juice:"Сок",cheese:"Сыр",cake:"Торт",bread:"Хлеб",chocolate:"Шоколад",borsch:"Борщ",venigret:"Винегрет",hamburger:"Гамбургер",mulledwine:"Глинтвейн",friedfish:"Жареная рыба",casserol:"Запеканка",italianassorted:"Итальянское ассорти",milkshake:"Молочный коктейль",frenchmeat:"Мясо по-французски",beerset:"Пивной сет",pizza:"Пицца",pilaf:"Плов",flemishribs:"Ребрышки по-фламандски",saladgreece:"Салат Греческий",saladcapital:"Салат Столичный",saladherring:"Сельдь под шубой",cider:"Сидр",saltwort:"Солянка",shawarma:"Шаурма",strudel:"Штрудель",sportshoes:"Кросовки",sportclothes:"Спортивная одежда",sunglasses:"Солнечные очки",bicycle:"Велосипед",dumbbells:"Гантели",rug:"Коврик",compression:"Компрессионная одежда",skates:"Коньки",skiing:"Лыжи",ball:"Мяч",mattress:"Надувной матрас",tent:"Палатка",rackets:"Ракетки",rubberboat:"Резиновая лодка",roller:"Роликовые коньки",backpack:"Рюкзак",kickscooter:"Электросамокат",sleeping:"Спальный мешок",thermos:"Термос",axe:"Топор",training:"Тренажер",flashlight:"Фонарь",helmet:"Шлем",rod:"Удочка",nutrition:"Спортивное питание",ladder:"Стремянка",umbrella:"Зонт",toothpaste:"Зубная паста",chair:"Кресло",bed:"Кровать",kitchen:"Кухонный гарнитур",detergent:"Моющее средство",soap:"Мыло",sofa:"Диван",beddress:"Постельные принадлежности",dishes:"Посуда",cleaner:"Пылесос",pan:"Сковорода",soappowder:"Стиральный порошок",table:"Стол",stool:"Стул",teapot:"Чайник",wardrobe:"Шкаф",dresser:"Комод",casserole:"Кастрюля",battery:"Батарейка",towel:"Полотенце",coffeemachine:"Кофемашина",iron:"Утюг",audio:"Аудиотехника",hob:"Варочная панель",hood:"Вытяжка",xbox:"Игровая приставка",foodprocessor:"Кухонный комбайн",microwave:"Микроволновка",mobile:"Смартфон",desktop:"Настольный компьютер",headphones:"Наушники",notebook:"Ноутбук",tablet:"Планшет",dishwasher:"Посудомоечная машина",printer:"Принтер",smartwatch:"Смарт часы",washer:"Стиральная машина",tv:"Телевизор",photo:"Фотоаппарат",refrigirator:"Холодильник",satellite:"Спутниковое оборудование",speaker:"Умная колонка",menhaircut:"Мужская стрижка",womenhaircut:"Женская стрижка",manicure:"Маникюр",cows:"Коровы",hens:"Куры",sheeps:"Овцы",pigs:"Свиньи",sable:"Соболь",paper:"Бумага",aluminium:"Алюминий",aromatisator:"Ароматизатор",dieselfuel:"Дизельное топливо",acid:"Кислота",leather:"Кожа",silicon:"Кремний",copper:"Медь",plastic:"Пластик",reagent:"Реактивы",rubber:"Резина",synthetics:"Синтетика",spirits:"Спирт",steel:"Сталь",glass:"Стекло",fabric:"Ткань",fertilizer:"Удобрения",wool:"Шерсть",parts:"Комплектующие",wires:"Провода",engine:"Двигатель",display:"Дисплей",chips:"Электронные компоненты",motherboard:"Материнская плата",bauxite:"Бокситы",clay:"Глина",wood:"Древесина",ironore:"Железная руда",gold:"Золото",copperore:"Медная руда",minerals:"Минералы",oil:"Нефть",sand:"Песок",coal:"Уголь",grape:"Виноград",potato:"Картофель",milk:"Молоко",meat:"Мясо",carrot:"Морковь",cucumber:"Огурцы",tomato:"Помидоры",fish:"Рыба",beet:"Свекла",fruits:"Фрукты",apples:"Яблоки",eggs:"Яйца",grain:"Зерно",cacao:"Какао",feed:"Корм",fur:"Мех",tools:"Инструменты",door:"Дверь",tile:"Керамическая плитка",glue:"Герметик",paint:"Краска",fasteners:"Крепеж",floor:"Напольные покрытия",heater:"Обогреватель",wallpaper:"Обои",window:"Окна",sanitary:"Сантехника",lamp:"Светильник",pipes:"Трубы",curtains:"Шторы",carpet:"Ковер",fittings:"Фурнитура",plaster:"Штукатурка",mirror:"Зеркало",conditioning:"Кондиционер",concrete:"Бетонный блок",brick:"Кирпич",cement:"Цемент",antibiotics:"Антибиотики",antiseptic:"Антисептик",supplements:"БАД",vaccine:"Вакцина",vitamins:"Витамины",contraceptives:"Контрацептивы",healingcream:"Лечебный крем",medtechnic:"Мед техника",tincture:"Настойка",orthopedic:"Ортопедические изделия",bandage:"Перевязочные средства",cough:"Противопростудные",prescription:"Рецептурные препараты",herbal:"Травяной сбор",lenses:"Линзы",herbs:"Лекарственные травы",microculture:"Микроорганическая культура",substance:"Фармацевтическая субстанция",autoloader:"Автопогрузчик",windgenerator:"Ветрогенератор",mineequipment:"Горное оборудование",truck:"Грузовик",crane:"Кран",device:"Прибор",machineline:"Производственная линия",machine:"Станки",tractor:"Трактор",heavyeq:"Тяжелое оборудование",beautyequipment:"Оборудование салона"};exports.PRODUCTS_TITLE_NAME=Object.entries(exports.PRODUCTS_NAME_TITLE).reduce(((acc,[name,title])=>({...acc,[title]:name})),{})},8455:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.WIKI_DIVISIONS_IMAGE_MAP=exports.WIKI_UNITS_MAP=void 0;const WIKI_UNITS=[{name:"warehouse.ore",title:"Склад материалов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.ore",divisions:[{image:"industrial:hangar1",name:"storage.ore",title:"Склад руды"},{image:"industrial:hangar2",name:"storage.hangar",title:"Ангар"},{image:"industrial:warehouse6",name:"storage.materials",title:"Склад материалов"},{image:"industrial:hangar3",name:"storage.constructions",title:"Стройматериалы"}]},{name:"warehouse.goods",title:"Склад товаров",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.goods",divisions:[{image:"industrial:warehouse5",name:"storage.electronics",title:"Склад электроники"},{image:"industrial:warehouse1",name:"storage.clothes",title:"Склад одежды"},{image:"industrial:warehouse2",name:"storage.furniture",title:"Мебельный склад"},{image:"industrial:warehouse3",name:"storage.goods",title:"Бытовые товары"},{image:"industrial:warehouse4",name:"storage.safe",title:"Сейф"},{image:"industrial:warehouse",name:"storage.pharma",title:"Фармацевтика"},{image:"industrial:warehouse6",name:"storage.sport",title:"Спорттовары"},{image:"industrial:warehouse2",name:"storage.child",title:"Детские товары"}]},{name:"warehouse.food",title:"Склад продуктов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.food",divisions:[{image:"industry:grainstore",name:"storage.grain",title:"Зернохранилище"},{image:"industry:grainstore",name:"storage.vegetables",title:"Овощехранилище"},{image:"industrial:warehouse1",name:"storage.refrigirator",title:"Холодильник"},{image:"industrial:warehouse3",name:"storage.drygoods",title:"Сухие продукты"}]},{name:"warehouse.equipment",title:"Склад техники",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.equipment",divisions:[{image:"industrial:hangar1",name:"storage.machines",title:"Техника"},{image:"industrial:hangar2",name:"storage.equipment",title:"Оборудование"},{image:"industrial:hangar3",name:"storage.parts",title:"Запчасти"}]},{name:"warehouse.chemicals",title:"Склад химикатов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.chemicals",divisions:[{image:"industry:chemicals",name:"storage.chemicals",title:"Химпродукты"},{image:"industry:oilstore",name:"storage.oil",title:"Нефтебаза"}]},{name:"warehouse.universal",title:"Универсальный склад",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=warehouse.universal",divisions:[{image:"industrial:hangar1",name:"storage.ore",title:"Склад руды"},{image:"industrial:hangar2",name:"storage.hangar",title:"Ангар"},{image:"industrial:warehouse6",name:"storage.materials",title:"Склад материалов"},{image:"industrial:hangar3",name:"storage.constructions",title:"Стройматериалы"},{image:"industry:chemicals",name:"storage.chemicals",title:"Химпродукты"},{image:"industry:oilstore",name:"storage.oil",title:"Нефтебаза"},{image:"industry:grainstore",name:"storage.grain",title:"Зернохранилище"},{image:"industry:grainstore",name:"storage.vegetables",title:"Овощехранилище"},{image:"industrial:warehouse1",name:"storage.refrigirator",title:"Холодильник"},{image:"industrial:warehouse3",name:"storage.drygoods",title:"Сухие продукты"},{image:"industrial:warehouse5",name:"storage.electronics",title:"Склад электроники"},{image:"industrial:warehouse1",name:"storage.clothes",title:"Склад одежды"},{image:"industrial:warehouse2",name:"storage.furniture",title:"Мебельный склад"},{image:"industrial:warehouse3",name:"storage.goods",title:"Бытовые товары"},{image:"industrial:warehouse4",name:"storage.safe",title:"Сейф"},{image:"industrial:hangar1",name:"storage.machines",title:"Техника"},{image:"industrial:hangar2",name:"storage.equipment",title:"Оборудование"},{image:"industrial:hangar3",name:"storage.parts",title:"Запчасти"},{image:"industrial:warehouse",name:"storage.pharma",title:"Фармацевтика"},{image:"industrial:warehouse6",name:"storage.sport",title:"Спорттовары"},{image:"industrial:warehouse2",name:"storage.child",title:"Детские товары"}]},{name:"shop.food",title:"Продуктовый магазин",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.food",divisions:[{image:"trade:supermarket6",name:"division.deli",title:"Гастроном"},{image:"trade:supermarket10",name:"division.silpo",title:"Семейный"},{image:"trade:supermarket3",name:"division.farmgoods",title:"Фермерский магазин"},{image:"trade:supermarket4",name:"division.supermarket",title:"Супермаркет"},{image:"trade:supermarket5",name:"division.grocery",title:"Бакалея"},{image:"trade:supermarket9",name:"division.cookies",title:"Кондитерская"},{image:"trade:supermarket7",name:"division.alkomarket",title:"Алкомаркет"},{image:"trade:supermarket8",name:"division.minimarket",title:"Минимаркет"}]},{name:"shop.apparel",title:"Магазин одежды",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.apparel",divisions:[{image:"trade:supermarket7",name:"division.womanclothes",title:"Женская одежда"},{image:"trade:supermarket5",name:"division.fashionableclothes",title:"Модная одежда"},{image:"trade:supermarket6",name:"division.everydayclothes",title:"Зимняя одежда"},{image:"trade:supermarket8",name:"division.shoeaccessories",title:"Обувь"},{image:"trade:supermarket4",name:"division.manclothes",title:"Мужская одежда"}]},{name:"shop.homegoods",title:"Универмаг",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.homegoods",divisions:[{image:"trade:supermarket5",name:"division.furniture",title:"Мебель"},{image:"trade:supermarket4",name:"division.1000trifles",title:"1000 мелочей"},{image:"trade:supermarket3",name:"division.homegoods",title:"Товары для дома"},{image:"trade:supermarket6",name:"division.departmentstore",title:"Универмаг"},{image:"trade:supermarket8",name:"division.home5",title:"Хозтовары"}]},{name:"shop.electronics",title:"Магазин электроники",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.electronics",divisions:[{image:"trade:supermarket8",name:"division.digitals",title:"Цифровая техника"},{image:"trade:supermarket3",name:"division.appliances",title:"Бытовая электроника"},{image:"trade:supermarket10",name:"division.electronics",title:"Бытовая техника"},{image:"trade:supermarket5",name:"division.computers",title:"Компьютеры"}]},{name:"shop.luxury",title:"Ювелирный магазин",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.luxury",divisions:[{image:"trade:supermarket7",name:"division.fashion",title:"Мода"},{image:"trade:supermarket6",name:"division.beauty",title:"Красота"},{image:"trade:supermarket5",name:"division.luxury",title:"Предметы роскоши"}]},{name:"shop.auto",title:"Автомагазин",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.auto",divisions:[{image:"trade:supermarket4",name:"division.auto",title:"Автосалон"},{image:"trade:supermarket7",name:"division.autoparts",title:"Автозапчасти"},{image:"trade:supermarket10",name:"division.garage",title:"Гараж"}]},{name:"shop.materials",title:"Магазин стройматериалов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.materials",divisions:[{image:"trade:supermarket3",name:"division.materials",title:"Отделочные материалы"},{image:"trade:supermarket10",name:"division.interior",title:"Интерьер"},{image:"trade:supermarket9",name:"division.decor",title:"Декор"},{image:"trade:supermarket4",name:"division.repair",title:"Ремонт"}]},{name:"shop.pharma",title:"Аптека",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.pharma",divisions:[{image:"trade:supermarket9",name:"division.medicine",title:"Медицина"},{image:"trade:supermarket8",name:"division.drug",title:"Лекарства"},{image:"trade:supermarket10",name:"division.pharmacy",title:"Аптека"}]},{name:"shop.sport",title:"Спортивный магазин",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.sport",divisions:[{image:"trade:supermarket6",name:"division.sport1",title:"Туризм"},{image:"trade:supermarket8",name:"division.sport3",title:"Отдых на природе"},{image:"trade:supermarket9",name:"division.sport4",title:"Активный спорт"},{image:"trade:supermarket7",name:"division.sport2",title:"Тренировки"},{image:"trade:supermarket10",name:"division.sport5",title:"Фитнес"}]},{name:"shop.child",title:"Детский магазин",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.child",divisions:[{image:"trade:supermarket9",name:"division.child1",title:"Детство"},{image:"trade:supermarket4",name:"division.child2",title:"Творчество"},{image:"trade:supermarket7",name:"division.child3",title:"Игрушки"}]},{name:"catering.restaurant",title:"Ресторан",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=catering.restaurant",divisions:[{image:"trade:supermarket3",name:"division.restaurant",title:"Ресторан"}]},{name:"factory.wood",title:"Деревообрабатывающий завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.wood",divisions:[{image:"factory:workshop1",name:"manufacture.furniture",title:"Мебельный цех"},{image:"factory:workshop2",name:"manufacture.consmaterials",title:"Цех стройматериалов"},{image:"factory:workshop",name:"manufacture.print",title:"Печатный цех"}]},{name:"factory.car",title:"Автомобильный завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.car",divisions:[{image:"factory:manufacture1",name:"manufacture.assembly",title:"Сборочный цех"},{image:"factory:manufacture2",name:"manufacture.parts",title:"Цех комплектующих"}]},{name:"factory.consmaterials",title:"Завод стройматериалов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.consmaterials",divisions:[{image:"factory:steel",name:"manufacture.cement",title:"Цементный цех"},{image:"factory:steel1",name:"manufacture.ceramics",title:"Керамический цех"},{image:"factory:steel2",name:"manufacture.glass",title:"Стекольный цех"},{image:"factory:steel3",name:"manufacture.metalworking",title:"Цех металлообработки"}]},{name:"factory.machinery",title:"Машиностроительный завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.machinery",divisions:[{image:"factory:workshop",name:"manufacture.machines",title:"Станкостроительный цех"},{image:"factory:workshop1",name:"manufacture.heavyeq",title:"Цех тяжелого оборудования"}]},{name:"factory.steel",title:"Металлургический завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.steel",divisions:[{image:"factory:steel",name:"manufacture.steel",title:"Литейный цех"}]},{name:"factory.food",title:"Пищевой завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.food",divisions:[{image:"factory:manufacture1",name:"manufacture.winery",title:"Разливочный цех"},{image:"factory:manufacture3",name:"manufacture.dairy",title:"Цех мясо-молочной продукции"},{image:"factory:manufacture2",name:"manufacture.bread",title:"Хлебобулочный цех"},{image:"factory:manufacture5",name:"manufacture.flour",title:"Мельничный цех"}]},{name:"factory.manufacture",title:"Фабрика",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.manufacture",divisions:[{image:"factory:manufacture1",name:"manufacture.shoes",title:"Обувной цех"},{image:"factory:manufacture2",name:"manufacture.sewing",title:"Пошивочный цех"},{image:"factory:manufacture5",name:"manufacture.tailoring",title:"Швейный цех"},{image:"factory:manufacture3",name:"manufacture.textile",title:"Ткацкий цех"},{image:"factory:manufacture4",name:"manufacture.leather",title:"Кожевенный цех"},{image:"factory:manufacture5",name:"manufacture.warmgoods",title:"Цех теплых вещей"}]},{name:"factory.chemicals",title:"Химический завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.chemicals",divisions:[{image:"factory:chemical",name:"manufacture.oilprocessing",title:"Нефтеперерабатывающий цех"},{image:"factory:chemical",name:"manufacture.oilchemicals",title:"Нефтехимический цех"},{image:"factory:chemical",name:"manufacture.chemicals",title:"Химический цех"}]},{name:"factory.electronics",title:"Электронный завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.electronics",divisions:[{image:"factory:manufacture2",name:"manufacture.computer",title:"Компьютерный цех"},{image:"factory:manufacture3",name:"manufacture.chips",title:"Микропроцессорный цех"},{image:"factory:manufacture4",name:"manufacture.homeapp",title:"Цех бытовой техники"},{image:"factory:manufacture1",name:"manufacture.kitchenapp",title:"Цех кухонной техники"},{image:"factory:manufacture5",name:"manufacture.electronics",title:"Цех электроники"}]},{name:"factory.jewelry",title:"Ювелирный завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.jewelry",divisions:[{image:"factory:manufacture3",name:"manufacture.watches",title:"Цех аксессуаров"},{image:"factory:manufacture4",name:"manufacture.jewelry",title:"Ювелирный цех"}]},{name:"factory.pharma",title:"Фармацевтический завод",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.pharma",divisions:[{image:"factory:manufacture2",name:"manufacture.drug",title:"Фармацевтический цех"},{image:"factory:manufacture3",name:"manufacture.medicine",title:"Медицинский цех"},{image:"factory:manufacture4",name:"manufacture.pharmacology",title:"Фармакологический цех"},{image:"factory:manufacture1",name:"manufacture.homechemicals",title:"Цех бытовой химии"}]},{name:"factory.sport",title:"Завод спортивных товаров",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=factory.sport",divisions:[{image:"factory:manufacture2",name:"manufacture.sportsewing",title:"Туристический отдел"},{image:"factory:manufacture3",name:"manufacture.sportsequipment",title:"Отдел инвентаря"},{image:"factory:manufacture4",name:"manufacture.sportassembly",title:"Отдел оборудования"},{image:"factory:manufacture1",name:"manufacture.plastic",title:"Цех пластмасс"}]},{name:"sciencelab.institute",title:"Лаборатория",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=sciencelab.institute",divisions:[{image:"trade:sciencelab",name:"science.food",title:"Кулинария"},{image:"trade:sciencelab",name:"science.light",title:"Ткани"},{image:"trade:sciencelab",name:"science.chemical",title:"Химия"},{image:"trade:sciencelab",name:"science.electronics",title:"Электроника"},{image:"trade:sciencelab",name:"science.car",title:"Легкое машиностроение"},{image:"trade:sciencelab",name:"science.engineering",title:"Тяжелое машиностроение"},{image:"trade:sciencelab",name:"science.metallurgy",title:"Металлургия"},{image:"trade:sciencelab",name:"science.jewelry",title:"Ювелирное дело"},{image:"trade:sciencelab",name:"science.extractive",title:"Сырье"},{image:"trade:sciencelab",name:"science.wood",title:"Деревообработка"},{image:"trade:sciencelab",name:"science.building",title:"Стройматериалы"},{image:"trade:sciencelab",name:"science.glass",title:"Обработка стекла"},{image:"trade:sciencelab",name:"science.pharma",title:"Фармацевтика"},{image:"trade:sciencelab",name:"science.sport",title:"Спорттовары"}]},{name:"animalfarm",title:"Животноводческая ферма",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=animalfarm",divisions:[{image:"animal:byre",name:"animalfarm.byre",title:"Коровник"},{image:"animal:piggery",name:"animalfarm.piggery",title:"Свинарник"},{image:"animal:hen",name:"animalfarm.coop",title:"Курятник"},{image:"animal:sheepcote",name:"animalfarm.sheepcote",title:"Овчарня"},{image:"animal:sable",name:"animalfarm.aviary",title:"Меховая ферма"}]},{name:"farm",title:"Земледельческая ферма",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=farm",divisions:[{image:"farm:farm",name:"farm.field",title:"Поле"},{image:"farm:garden",name:"farm.garden",title:"Сад"}]},{name:"greenhouse",title:"Тепличное хозяйство",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=greenhouse",divisions:[{image:"farm:greenery",name:"farm.pharma",title:"Теплица"}]},{name:"mine.oilwell",title:"Нефтяная скважина",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.oilwell",divisions:[{image:"mines:oiltower",name:"mine.oilpump",title:"Нефтяная вышка"}]},{name:"mine.gold",title:"Золотая шахта",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.gold",divisions:[{image:"mines:mine",name:"mine.minedivision",title:"Шахтерская бригада"}]},{name:"mine.coal",title:"Угольная шахта",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.coal",divisions:[{image:"mines:mine",name:"mine.minedivision",title:"Шахтерская бригада"}]},{name:"mine.ironore",title:"Железнорудная шахта",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.ironore",divisions:[{image:"mines:mine",name:"mine.minedivision",title:"Шахтерская бригада"}]},{name:"mine.bauxite",title:"Бокситный карьер",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.bauxite",divisions:[{image:"mines:pit",name:"mine.pitdivision",title:"Бригада"}]},{name:"mine.clay",title:"Глиняный карьер",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.clay",divisions:[{image:"mines:pit",name:"mine.pitdivision",title:"Бригада"}]},{name:"mine.sand",title:"Песчаный карьер",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.sand",divisions:[{image:"mines:pit",name:"mine.pitdivision",title:"Бригада"}]},{name:"mine.copper",title:"Медный рудник",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.copper",divisions:[{image:"mines:mine",name:"mine.minedivision",title:"Шахтерская бригада"}]},{name:"sawmill",title:"Лесопилка",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=sawmill",divisions:[{image:"factory:sawmill",name:"mine.wooddivision",title:"Лесопильная бригада"}]},{name:"fishfarm",title:"Рыбное хозяйство",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=fishfarm",divisions:[{image:"factory:fishfarm",name:"mine.fishdivision",title:"Рыболовецкая бригада"}]},{name:"mine.minerals",title:"Шахта минералов",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=mine.minerals",divisions:[{image:"mines:pit",name:"mine.pitdivision",title:"Бригада"}]},{name:"constructionunit",title:"Строительное предприятие",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=constructionunit",divisions:[{image:"construction:unit",name:"division.constructor",title:"Бригада"}]},{name:"cargounit",title:"Транспортное предприятие",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=cargounit",divisions:[{image:"industry:delivery1",name:"division.cargo",title:"Транспортный отдел"}]},{name:"powerstation",title:"Электростанция",link:"https://bizmania.ru/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=powerstation",divisions:[{image:"factory:generator",name:"division.windmill",title:"Поле ветряков"}]}];exports.WIKI_UNITS_MAP=new Map(WIKI_UNITS.map((unit=>[unit.name,unit])));exports.WIKI_DIVISIONS_IMAGE_MAP=new Map(WIKI_UNITS.flatMap((unit=>unit.divisions.map((division=>[division.image,division])))))},4179:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.loadInfo=void 0;const loadInfo=async divisionId=>{const sp=new URLSearchParams(document.location.search);const division=divisionId??Number(sp.get("division"));if(!division){return}const info=sessionStorage.getItem(`E${division}_pinfo`);if(!info){return}return JSON.parse(info)};exports.loadInfo=loadInfo},986:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.saveInfo=void 0;const saveInfo=async({Elinfo,QEmpSel,CurrEqSel,MaxEqSel,QEqSel,QNeedSel})=>{const sp=new URLSearchParams(document.location.search);const division=Number(sp.get("division"));if(!division){return}const info={QEmp:parseFloat(Elinfo.querySelector(QEmpSel)?.textContent??"0"),CurrEq:parseInt(Elinfo.querySelector(CurrEqSel)?.textContent?.replace(/\s/g,"")??"0"),MaxEq:parseInt(Elinfo.querySelector(MaxEqSel)?.textContent?.replace(/\s/g,"")??"0"),QEq:parseFloat(Elinfo.querySelector(QEqSel)?.textContent??"0"),QNeed:QNeedSel?parseFloat(Elinfo.querySelector(QNeedSel)?.textContent??"0"):0};sessionStorage.setItem(`E${division}_pinfo`,JSON.stringify(info))};exports.saveInfo=saveInfo},1035:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addOptSellInfo=void 0;const getOptPrices_1=__webpack_require__(1117);const formatNumber_1=__webpack_require__(897);const addOptSellInfo=async({productId,idShop,city,CityOffer,sort,CurrQ,addHead},mount,AddLine="")=>{const html=await getOptSellHtml({productId,idShop,CurrVendor:-1,arDParam:{city,CityOffer,important:false,sort},CityQ:0,CurrQ,hideSet:true,addHead,styles:"max-width: 100%;",setQ:true});const newElement=document.createElement("div");newElement.style.setProperty("float","left");newElement.innerHTML=AddLine+html;mount(newElement)};exports.addOptSellInfo=addOptSellInfo;const getOptSellHtml=async({productId,idShop,CurrVendor,arDParam,CityQ,CurrQ,hideSet,addHead="",styles="max-width: 550px; width:100%",setQ=false})=>{const vendors=await(0,getOptPrices_1.getOptVendors)({productId,cityId:arDParam.city,cityOffer:typeof arDParam.CityOffer!=="undefined"?arDParam.CityOffer:false,important:typeof arDParam.important!=="undefined"?arDParam.important:false,sortOrder:typeof arDParam.sort!=="undefined"?arDParam.sort:""});const arDString=vendors.reduce(((acc,vendor,ind)=>{const{amount,buildingId,cityTitle,companyTitle,customs,deliveryDays,deliveryPrice,isMine,priceQuality,quality,totalPrice}=vendor;const companyStyle=buildingId==CurrVendor?"background-color: rgb(198, 236, 255);":"";const companyValue=isMine?"<b>"+companyTitle+"</b>":companyTitle;const newPrice=CurrQ*priceQuality;const priceStyle=CityQ>0&&CityQ<priceQuality?"background-color: lightpink; text-decoration: line-through;":"";return acc+`<tr class="tbl${ind%2?"g":""}r">`+`   <td style="${companyStyle}">${companyValue}</td>`+`   <td title="${deliveryPrice} + ${customs}">${cityTitle}${deliveryDays>0?"&nbsp;<b> &#"+(9311+deliveryDays)+";</b>":""}</td>`+`   <td align=right><nobr>${(0,formatNumber_1.formatNumber)(amount.toFixed(0))}</nobr></td>`+`   <td align=center>${quality}</td>`+`   <td align=right><nobr>${(0,formatNumber_1.formatMoney)(totalPrice.toFixed(totalPrice>100?0:2))}</nobr></td>`+`   <td align=center style="${priceStyle}">`+(setQ?`<a href=# onclick="document.querySelector('#price_ctrl').value='${newPrice.toFixed(newPrice>100?0:2)}'; document.getElementById('submit').style.display='inline'; return false;">${(0,formatNumber_1.formatMoney)(priceQuality.toFixed(priceQuality>100?0:2))}</a>`:(0,formatNumber_1.formatMoney)(priceQuality.toFixed(priceQuality>100?0:2)))+`</td>`+(addHead?"<td data-id="+buildingId+(priceQuality<CurrQ||isNaN(CurrQ)?' style="background-color: lightgreen;"':"")+"><nobr>"+(hideSet?"":'<button data-type=set class=AddToStockGoods onclick="return false;">&#128722;</button> ')+'<input type=number value=0 class=smA style="width:70px"><button data-type=buy class=AddToStockGoods onclick="return false;">&#10009;</button></nobr></td>':"")+`</tr>`}),"");return`<table data-idProd=${productId} data-idShop=${idShop} data-CurrVendor=${CurrVendor} class="datatable" cellpadding="5" cellspacing="0" border="0" style="${styles}">`+`   <thead><tr class="tblhr">`+`       <td class="tblh1">Компания</td>`+`       <td class="tblh">Город</td>`+`       <td class="tblh">Объем</td>`+`       <td class="tblh">Качество</td>`+`       <td class="tblh">Цена</td>`+`       <td class="tblh">за качество</td>${addHead}`+`   </tr></thead>`+`   <tbody>${arDString}</tbody>`+`</table>`}},4028:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addWikiLink=void 0;const products_1=__webpack_require__(9438);const addWikiLink=(txt,el)=>{const product=products_1.PRODUCTS_TITLE_NAME[txt];if(!product){return}const wl=document.createElement("a");wl.target="_blank";wl.href=`/wikihelp/?topic=Справочник+продуктов&product=${product}`;wl.innerHTML="(&#8505;)";el.appendChild(document.createTextNode(" "));el.appendChild(wl)};exports.addWikiLink=addWikiLink},7647:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.loadDataTablePages=void 0;const filters_1=__webpack_require__(3680);const getHtml_1=__webpack_require__(2326);const loadDataTablePages=async()=>{const dataTable=document.querySelector("table.dataTable");const bodyEl=dataTable?.querySelector("tbody")??undefined;const footerEl=dataTable?.querySelector("tfoot")??undefined;const options=getPageNavigatorOptions();if(!bodyEl||!footerEl||!options)return;const pagePromises=new Array(options.pages).fill(0).map(((_,i)=>i+1)).filter((p=>p!==options.current)).map((async p=>{const dlh=document.location.host;const dlp=document.location.pathname;const sp=new URLSearchParams(document.location.search);sp.set(options.param,p.toString());const url=`${dlh}${dlp}?${sp.toString()}`;try{const doc=await(0,getHtml_1.getHtml)(url);const rows=doc?.querySelectorAll("table.dataTable tbody tr");return rows?{p,rows:[...rows]}:undefined}catch(e){}}));const pages=(await Promise.all(pagePromises)).filter(filters_1.notUndefined);const prependRows=pages.filter((({p})=>p<options.current)).map((({rows})=>rows)).flat();const appendRows=pages.filter((({p})=>p>options.current)).map((({rows})=>rows)).flat();bodyEl.prepend(...prependRows);bodyEl.append(...appendRows)};exports.loadDataTablePages=loadDataTablePages;const getPageNavigatorOptions=()=>{const[scriptText]=[...document.querySelectorAll("script")].filter((script=>script.innerHTML.includes("createPGNavigator"))).map((script=>script.innerHTML));const args=scriptText.match(/createPGNavigator\((.*)\)/)?.[1];const[name,formname,param,current,pages,width,clearParam,sortParam]=JSON.parse(`[${args}]`);return{name,formname,param,current,pages,width,clearParam,sortParam}}},3793:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upgradeMainMenu=void 0;const upgradeMainMenu=async myCompanyId=>{const LINKS=[{url:"/wikihelp/?topic=%D0%92%D0%B8%D0%B4%D1%8B+%D0%BF%D1%80%D0%B5%D0%B4%D0%BF%D1%80%D0%B8%D1%8F%D1%82%D0%B8%D0%B9&unit=shop.food",text:"Food wiki"},{url:`/company/?id=${myCompanyId}&tab=reports&section=accountlog&category=1&trantype=income`,text:"Income"},{url:`/company/?id=${myCompanyId}&tab=reports&section=accountlog&category=1&trantype=distribute+tender+redemption`,text:"Income Tender"}];const dm=document.querySelectorAll("div#divmenu div.smenu table tbody ")[4];if(!dm){return}LINKS.forEach((({url,text})=>{const linkRow=document.createElement("tr");const linkCell=document.createElement("td");const linkLink=document.createElement("a");linkLink.setAttribute("onclick","this.blur()");linkLink.className="smenulnk";linkCell.setAttribute("colspan","3");linkCell.setAttribute("nowrap","");linkRow.className="smenutd";linkLink.setAttribute("href",url);linkLink.text=` ${text} `;linkCell.appendChild(linkLink);linkRow.appendChild(linkCell);dm.appendChild(linkRow)}))};exports.upgradeMainMenu=upgradeMainMenu},9894:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upProductionSale=void 0;const getMyCompany_1=__webpack_require__(8591);const addOptSellInfo_1=__webpack_require__(1035);const upProductionSale=async(isLocal=false)=>{const sp=new URLSearchParams(document.location.search);const unitId=Number(sp.get("id"));const productId=Number(sp.get("product"));const tab=sp.get("tab")??"goods";const stab=sp.get("stab")??"sales";const sort=sp.get("srt")??"";const parentElement=document.querySelector("div#content div.tabbodyie form");const infoTable=parentElement?.querySelector("& > table > tbody > tr:nth-child(1) > td > table > tbody");if(!productId||!unitId||!parentElement||!infoTable||tab!=="goods"||stab!=="sales"){return}const{cityId}=await(0,getMyCompany_1.getMyCompany)();const qualityEl=infoTable.querySelector("& > tr:nth-child(2) > td:nth-child(2)");const quality=parseFloat(qualityEl?.textContent??"0");{const sourcePriceQuality=addPriceQualityInfo(quality,infoTable.querySelector("& > tr:nth-child(3) > td:nth-child(2)"),infoTable.querySelector("& > tr:nth-child(3) > td:nth-child(1)"));addPriceQualityInfo(quality,infoTable.querySelector("#price_ctrl"),infoTable.querySelector("& > tr:nth-child(4) > td:nth-child(1)"),sourcePriceQuality);addPriceQualityInfo(quality,infoTable.querySelector("#internalPrice_ctrl"),infoTable.querySelector("& > tr:nth-child(5) > td:nth-child(1)"),sourcePriceQuality);addPriceQualityInfo(quality,infoTable.querySelector("#corporatePrice_ctrl"),infoTable.querySelector("& > tr:nth-child(5) > td:nth-child(3)"),sourcePriceQuality)}const CityOffer=isLocal||!!sort;const linkQualitySort=new URLSearchParams({id:String(unitId),tab,stab,product:String(productId)});const linkPriceSort=new URLSearchParams(linkQualitySort);linkPriceSort.append("srt","total_cost");const tableHeader=isLocal?undefined:[`<a href="?${linkQualitySort}">Q</a>`,`<a href="?${linkPriceSort}">Price</a><br>`].join(" | ");await(0,addOptSellInfo_1.addOptSellInfo)({productId,idShop:unitId,city:cityId,CityOffer,sort,CurrQ:quality},(div=>{parentElement.after(div)}),tableHeader)};exports.upProductionSale=upProductionSale;const addPriceQualityInfo=(quality,priceEl,mountEl,sourcePriceQuality)=>{if(!priceEl||!mountEl){return}mountEl.style.display="flex";mountEl.style.flexFlow="column";const getPriceValue=()=>{const priceString="value"in priceEl?priceEl?.value:priceEl?.textContent;return parseFloat((priceString||"0").replace(/\s+|p/gi,""))};const price=getPriceValue();const priceQuality=price/quality;if(isNaN(priceQuality)||!isFinite(priceQuality)||priceQuality===0){return 0}const priceQualityEl=document.createElement("b");priceQualityEl.style.display="flex";priceQualityEl.style.flexFlow="row";priceQualityEl.textContent=priceQuality.toFixed(2);mountEl.appendChild(priceQualityEl);if(sourcePriceQuality){const diff=(priceQuality-sourcePriceQuality)/sourcePriceQuality*100;const diffEl=document.createElement("b");diffEl.style.color=diff>0?"green":diff<0?"red":"black";diffEl.innerHTML=`&nbsp;(${diff>0?"+":""}${diff.toFixed(2)}%)`;priceQualityEl.appendChild(diffEl)}if("value"in priceEl){const actions=document.createElement("div");actions.style.display="flex";actions.style.flexFlow="row";actions.style.gap="20px";mountEl.appendChild(actions);const fall=document.createElement("a");fall.textContent="-10%";fall.href="#";fall.style.color="red";fall.onclick=()=>{priceEl.value=(getPriceValue()*.9).toFixed(2);return false};actions.appendChild(fall);const rise=document.createElement("a");rise.textContent="+10%";rise.href="#";rise.style.color="green";rise.onclick=()=>{priceEl.value=(getPriceValue()*1.1).toFixed(2);return false};actions.appendChild(rise)}return priceQuality}},9304:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upgradeQualityInput=void 0;const upgradeQualityInput=()=>{const elements=document.querySelectorAll("#produce > tbody > tr > td:nth-child(13)  > div");[...elements].forEach((el=>{const inputEl=el.querySelector("input");if(!inputEl){return}const index=parseInt(inputEl.name.replace(/[^\d]/gi,""));const qualityCell=document.getElementById("dr_"+index);const qualityValue=parseFloat(qualityCell?.textContent??"1");const html=`<input\n            step="0.01"\n            type="number"\n            value="${qualityValue}"\n            onchange="document.getElementById('dressing[${index}]_ctrl').value=\n                    (this.value - products[${index}][5])/(products[${index}][6] - products[${index}][5]);\n                changeRow(${index});\n                return false;"\n        >`;const newInputEl=document.createElement("input");el.style.display="none";el.parentElement?.appendChild(newInputEl);newInputEl.outerHTML=html}))};exports.upgradeQualityInput=upgradeQualityInput},6843:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.upLoadAllPagesAction=exports.upLoadAllPages=void 0;const createIconButton_1=__webpack_require__(8166);const loadDataTablePages_1=__webpack_require__(7647);const getContainer=()=>document.querySelector("table.dataTable tfoot .page-nav");const upLoadAllPages=()=>{const container=getContainer();if(!container)return;const span=document.createElement("span");span.style.padding="0 5px";container.append(span);(0,createIconButton_1.createIconButton)({title:"загрузить все",parentElement:span,showProgress:true,onClick:exports.upLoadAllPagesAction})};exports.upLoadAllPages=upLoadAllPages;const upLoadAllPagesAction=async()=>{await(0,loadDataTablePages_1.loadDataTablePages)();const container=getContainer();container?.remove()};exports.upLoadAllPagesAction=upLoadAllPagesAction},8478:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.addFontAwesome=void 0;let fontAwesomeAdded=false;const addFontAwesome=async()=>{if(fontAwesomeAdded){return}fontAwesomeAdded=true;createStyleSheet("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css");addCSStyle([{name:"fa-check",type:".",properties:[{color:"green"}]}])};exports.addFontAwesome=addFontAwesome;function createStyleSheet(href){let element;if(typeof href!=="undefined"){element=document.createElement("link");element.type="text/css";element.rel="stylesheet";element.href=href}else{element=document.createElement("style");element.type="text/css"}document.getElementsByTagName("head")[0].appendChild(element);let sheet=document.styleSheets[document.styleSheets.length-1];if(typeof sheet.addRule==="undefined"){sheet.addRule=(selectorText,cssText,index)=>{if(typeof index==="undefined"){index=sheet.cssRules.length}return sheet.insertRule(selectorText+" {"+cssText+"}",index)}}if(typeof sheet.removeRule==="undefined"){sheet.removeRule=sheet.deleteRule}return sheet}function addCSStyle(classes){const sheetN=createStyleSheet();classes.forEach((classItem=>{for(let propertyObj of classItem.properties){for(let property in propertyObj){sheetN.addRule(`${classItem.type}${classItem.name}`,`${property}: ${propertyObj[property]}`)}}}))}},6865:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.copyToClipboard=void 0;async function copyToClipboard(val){const getClipboardItems=()=>{if(Array.isArray(val)){const text=val.map((e=>Array.isArray(e)?e.join(","):e)).join("\n")+"\n";return new ClipboardItem({"text/csv":new Blob([text],{type:"text/csv"})})}else{return new ClipboardItem({"text/plain":new Blob([val],{type:"text/plain"})})}};try{await navigator.clipboard.write([getClipboardItems()])}catch(err){console.error("Error in copying text: ",err)}}exports.copyToClipboard=copyToClipboard},8166:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.createIconButton=void 0;const addFontAwesome_1=__webpack_require__(8478);const wrapLoadIndicator_1=__webpack_require__(1286);const createIconButton=({href,title,icon,iconTitle,onClick,parentElement,showProgress=false,addGap=false})=>{const linkEl=document.createElement("a");linkEl.text=title??"";linkEl.href=href??"#";if(addGap){linkEl.style.marginLeft="5px"}const clickHandler=async e=>{if(!onClick){return}e.preventDefault();if(showProgress){(0,wrapLoadIndicator_1.wrapLoadIndicator)(linkEl,onClick)}else{try{await onClick()}catch(e){console.error(e)}}};linkEl.onclick=onClick?clickHandler:()=>void 0;if(icon){const iconEl=document.createElement("i");iconEl.classList.add("fa");iconEl.classList.add(icon);iconEl.setAttribute("aria-hidden","true");iconEl.setAttribute("title",iconTitle??"");linkEl.appendChild(iconEl);(0,addFontAwesome_1.addFontAwesome)()}parentElement?.appendChild(linkEl);return linkEl};exports.createIconButton=createIconButton},3680:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.notEmpty=exports.notUndefined=void 0;const notUndefined=value=>value!==undefined;exports.notUndefined=notUndefined;const notEmpty=value=>Boolean(value);exports.notEmpty=notEmpty},897:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.formatNumber=exports.formatMoney=void 0;const moneyFormat=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",signDisplay:"auto",minimumFractionDigits:0,maximumFractionDigits:2});const formatMoney=val=>{const value=parseFloat(val);return isNaN(value)?val:moneyFormat.format(value).replace(" "," ").replace(",",".").replace("₽","р.")};exports.formatMoney=formatMoney;const formatNumber=val=>{const value=parseFloat(val);return isNaN(value)?val:value.toLocaleString("ru-RU").replace(",",".")};exports.formatNumber=formatNumber},2326:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.getHtml=void 0;const p_queue_1=__importDefault(__webpack_require__(3361));const queue=new p_queue_1.default({concurrency:3});const getHtml=async url=>{const response=await queue.add((()=>fetch(url)));if(!response||!response.ok){return}const htmlString=await response.text();const frame=document.createElement("frame");frame.innerHTML=htmlString.trim();if(!frame.innerText){return}return frame};exports.getHtml=getHtml},9965:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.getJson=void 0;const getJson=async url=>{const response=await fetch(url);if(!response||!response.ok){return}return await response.json()};exports.getJson=getJson},4822:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.insertAfter=void 0;const insertAfter=function(node,referenceNode){if(!node||!referenceNode){return}const parent=referenceNode.parentNode;const nextSibling=referenceNode.nextSibling;if(nextSibling&&parent){parent.insertBefore(node,referenceNode.nextSibling)}else if(parent){parent.appendChild(node)}};exports.insertAfter=insertAfter},1286:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.wrapLoadIndicator=void 0;const wrapLoadIndicator=async(el,fn)=>{addStyles();const holder=document.createElement("div");holder.className="gm-bm-holder";el.parentElement?.insertBefore(holder,el);const loader=document.createElement("span");loader.className="gm-bm-loader";holder.appendChild(loader);const display=el.style.display;el.style.display="none";try{await fn()}finally{holder.remove();el.style.display=display}};exports.wrapLoadIndicator=wrapLoadIndicator;function addStyleSheet(styleText){let s=document.createElement("style");s.appendChild(document.createTextNode(styleText));document.getElementsByTagName("head")[0].appendChild(s)}let stylesAdded=false;const addStyles=()=>{if(stylesAdded){return}addStyleSheet(`\n    .gm-bm-holder {\n        display: inline-block;\n        position: relative;\n    }\n    .gm-bm-loader {\n        transform: rotateZ(45deg);\n        perspective: 1000px;\n        border-radius: 50%;\n        width: 48px;\n        height: 48px;\n        color: #5165a4;\n    }\n    \n    .gm-bm-loader:before,\n    .gm-bm-loader:after {\n        content: '';\n        display: block;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: inherit;\n        height: inherit;\n        border-radius: 50%;\n        transform: rotateX(70deg);\n        animation: 1s spin linear infinite;\n    }\n    \n    .gm-bm-loader:after {\n        color: #FF3D00;\n        transform: rotateY(70deg);\n        animation-delay: .4s;\n    }\n    \n    @keyframes rotate {\n        0% {\n            transform: translate(-50%, -50%) rotateZ(0deg);\n        }\n    \n        100% {\n            transform: translate(-50%, -50%) rotateZ(360deg);\n        }\n    }\n    \n    @keyframes rotateccw {\n        0% {\n            transform: translate(-50%, -50%) rotate(0deg);\n        }\n    \n        100% {\n            transform: translate(-50%, -50%) rotate(-360deg);\n        }\n    }\n    \n    @keyframes spin {\n    \n        0%,\n        100% {\n            box-shadow: .2em 0px 0 0px currentcolor;\n        }\n    \n        12% {\n            box-shadow: .2em .2em 0 0 currentcolor;\n        }\n    \n        25% {\n            box-shadow: 0 .2em 0 0px currentcolor;\n        }\n    \n        37% {\n            box-shadow: -.2em .2em 0 0 currentcolor;\n        }\n    \n        50% {\n            box-shadow: -.2em 0 0 0 currentcolor;\n        }\n    \n        62% {\n            box-shadow: -.2em -.2em 0 0 currentcolor;\n        }\n    \n        75% {\n            box-shadow: 0px -.2em 0 0 currentcolor;\n        }\n    \n        87% {\n            box-shadow: .2em -.2em 0 0 currentcolor;\n        }\n    }\n    `)}},3361:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:()=>PQueue});var eventemitter3=__webpack_require__(792);const node_modules_eventemitter3=null&&EventEmitter;class TimeoutError extends Error{constructor(message){super(message);this.name="TimeoutError"}}class AbortError extends Error{constructor(message){super();this.name="AbortError";this.message=message}}const getDOMException=errorMessage=>globalThis.DOMException===undefined?new AbortError(errorMessage):new DOMException(errorMessage);const getAbortedReason=signal=>{const reason=signal.reason===undefined?getDOMException("This operation was aborted."):signal.reason;return reason instanceof Error?reason:getDOMException(reason)};function pTimeout(promise,options){const{milliseconds,fallback,message,customTimers={setTimeout,clearTimeout}}=options;let timer;const wrappedPromise=new Promise(((resolve,reject)=>{if(typeof milliseconds!=="number"||Math.sign(milliseconds)!==1){throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${milliseconds}\``)}if(options.signal){const{signal}=options;if(signal.aborted){reject(getAbortedReason(signal))}signal.addEventListener("abort",(()=>{reject(getAbortedReason(signal))}))}if(milliseconds===Number.POSITIVE_INFINITY){promise.then(resolve,reject);return}const timeoutError=new TimeoutError;timer=customTimers.setTimeout.call(undefined,(()=>{if(fallback){try{resolve(fallback())}catch(error){reject(error)}return}if(typeof promise.cancel==="function"){promise.cancel()}if(message===false){resolve()}else if(message instanceof Error){reject(message)}else{timeoutError.message=message??`Promise timed out after ${milliseconds} milliseconds`;reject(timeoutError)}}),milliseconds);(async()=>{try{resolve(await promise)}catch(error){reject(error)}})()}));const cancelablePromise=wrappedPromise.finally((()=>{cancelablePromise.clear()}));cancelablePromise.clear=()=>{customTimers.clearTimeout.call(undefined,timer);timer=undefined};return cancelablePromise}function lowerBound(array,value,comparator){let first=0;let count=array.length;while(count>0){const step=Math.trunc(count/2);let it=first+step;if(comparator(array[it],value)<=0){first=++it;count-=step+1}else{count=step}}return first}class PriorityQueue{#queue=[];enqueue(run,options){options={priority:0,...options};const element={priority:options.priority,run};if(this.size&&this.#queue[this.size-1].priority>=options.priority){this.#queue.push(element);return}const index=lowerBound(this.#queue,element,((a,b)=>b.priority-a.priority));this.#queue.splice(index,0,element)}dequeue(){const item=this.#queue.shift();return item?.run}filter(options){return this.#queue.filter((element=>element.priority===options.priority)).map((element=>element.run))}get size(){return this.#queue.length}}class PQueue extends eventemitter3{#carryoverConcurrencyCount;#isIntervalIgnored;#intervalCount=0;#intervalCap;#interval;#intervalEnd=0;#intervalId;#timeoutId;#queue;#queueClass;#pending=0;#concurrency;#isPaused;#throwOnTimeout;timeout;constructor(options){super();options={carryoverConcurrencyCount:false,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:true,queueClass:PriorityQueue,...options};if(!(typeof options.intervalCap==="number"&&options.intervalCap>=1)){throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${options.intervalCap?.toString()??""}\` (${typeof options.intervalCap})`)}if(options.interval===undefined||!(Number.isFinite(options.interval)&&options.interval>=0)){throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${options.interval?.toString()??""}\` (${typeof options.interval})`)}this.#carryoverConcurrencyCount=options.carryoverConcurrencyCount;this.#isIntervalIgnored=options.intervalCap===Number.POSITIVE_INFINITY||options.interval===0;this.#intervalCap=options.intervalCap;this.#interval=options.interval;this.#queue=new options.queueClass;this.#queueClass=options.queueClass;this.concurrency=options.concurrency;this.timeout=options.timeout;this.#throwOnTimeout=options.throwOnTimeout===true;this.#isPaused=options.autoStart===false}get#doesIntervalAllowAnother(){return this.#isIntervalIgnored||this.#intervalCount<this.#intervalCap}get#doesConcurrentAllowAnother(){return this.#pending<this.#concurrency}#next(){this.#pending--;this.#tryToStartAnother();this.emit("next")}#onResumeInterval(){this.#onInterval();this.#initializeIntervalIfNeeded();this.#timeoutId=undefined}get#isIntervalPaused(){const now=Date.now();if(this.#intervalId===undefined){const delay=this.#intervalEnd-now;if(delay<0){this.#intervalCount=this.#carryoverConcurrencyCount?this.#pending:0}else{if(this.#timeoutId===undefined){this.#timeoutId=setTimeout((()=>{this.#onResumeInterval()}),delay)}return true}}return false}#tryToStartAnother(){if(this.#queue.size===0){if(this.#intervalId){clearInterval(this.#intervalId)}this.#intervalId=undefined;this.emit("empty");if(this.#pending===0){this.emit("idle")}return false}if(!this.#isPaused){const canInitializeInterval=!this.#isIntervalPaused;if(this.#doesIntervalAllowAnother&&this.#doesConcurrentAllowAnother){const job=this.#queue.dequeue();if(!job){return false}this.emit("active");job();if(canInitializeInterval){this.#initializeIntervalIfNeeded()}return true}}return false}#initializeIntervalIfNeeded(){if(this.#isIntervalIgnored||this.#intervalId!==undefined){return}this.#intervalId=setInterval((()=>{this.#onInterval()}),this.#interval);this.#intervalEnd=Date.now()+this.#interval}#onInterval(){if(this.#intervalCount===0&&this.#pending===0&&this.#intervalId){clearInterval(this.#intervalId);this.#intervalId=undefined}this.#intervalCount=this.#carryoverConcurrencyCount?this.#pending:0;this.#processQueue()}#processQueue(){while(this.#tryToStartAnother()){}}get concurrency(){return this.#concurrency}set concurrency(newConcurrency){if(!(typeof newConcurrency==="number"&&newConcurrency>=1)){throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${newConcurrency}\` (${typeof newConcurrency})`)}this.#concurrency=newConcurrency;this.#processQueue()}async#throwOnAbort(signal){return new Promise(((_resolve,reject)=>{signal.addEventListener("abort",(()=>{reject(signal.reason)}),{once:true})}))}async add(function_,options={}){options={timeout:this.timeout,throwOnTimeout:this.#throwOnTimeout,...options};return new Promise(((resolve,reject)=>{this.#queue.enqueue((async()=>{this.#pending++;this.#intervalCount++;try{options.signal?.throwIfAborted();let operation=function_({signal:options.signal});if(options.timeout){operation=pTimeout(Promise.resolve(operation),{milliseconds:options.timeout})}if(options.signal){operation=Promise.race([operation,this.#throwOnAbort(options.signal)])}const result=await operation;resolve(result);this.emit("completed",result)}catch(error){if(error instanceof TimeoutError&&!options.throwOnTimeout){resolve();return}reject(error);this.emit("error",error)}finally{this.#next()}}),options);this.emit("add");this.#tryToStartAnother()}))}async addAll(functions,options){return Promise.all(functions.map((async function_=>this.add(function_,options))))}start(){if(!this.#isPaused){return this}this.#isPaused=false;this.#processQueue();return this}pause(){this.#isPaused=true}clear(){this.#queue=new this.#queueClass}async onEmpty(){if(this.#queue.size===0){return}await this.#onEvent("empty")}async onSizeLessThan(limit){if(this.#queue.size<limit){return}await this.#onEvent("next",(()=>this.#queue.size<limit))}async onIdle(){if(this.#pending===0&&this.#queue.size===0){return}await this.#onEvent("idle")}async#onEvent(event,filter){return new Promise((resolve=>{const listener=()=>{if(filter&&!filter()){return}this.off(event,listener);resolve()};this.on(event,listener)}))}get size(){return this.#queue.size}sizeBy(options){return this.#queue.filter(options).length}get pending(){return this.#pending}get isPaused(){return this.#isPaused}}}};var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__);return module.exports}(()=>{__webpack_require__.d=(exports,definition)=>{for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}})();(()=>{__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)})();(()=>{__webpack_require__.r=exports=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})}})();var __webpack_exports__={};(()=>{var exports=__webpack_exports__;var __webpack_unused_export__;__webpack_unused_export__={value:true};const pages_1=__webpack_require__(3826);const getMyCompany_1=__webpack_require__(8591);const mainMenu_1=__webpack_require__(3793);(async function(){const dlh=document.location.host;const dlp=document.location.pathname;const sp=new URLSearchParams(document.location.search);if(dlh!=="bizmania.ru"){return}if(dlp.startsWith("/user/messages")){return}const{companyId}=await(0,getMyCompany_1.getMyCompany)();if(!!companyId){(0,mainMenu_1.upgradeMainMenu)(companyId)}switch(true){case dlp.startsWith("/user/gameshop"):{switch(sp.get("tab")){case"weeklypacks":{(0,pages_1.onWeeklyPacksPage)();break}}break}case dlp.startsWith("/city"):{(0,pages_1.onCityPage)();break}case dlp.startsWith("/company"):{(0,pages_1.onCompanyPage)();break}case dlp.startsWith("/corporation"):{(0,pages_1.onCorporationPage)();break}case dlp.startsWith("/units/vendor/select"):{(0,pages_1.onVendorSelectPage)();break}case dlp.startsWith("/units/equipment/purchase"):{(0,pages_1.onEquipmentPurchasePage)();break}case dlp.startsWith("/units/animalfarm"):{(0,pages_1.onAnimalFarmPage)();break}case dlp.startsWith("/units/greenhouse"):{(0,pages_1.onGreenhousePage)();break}case dlp.startsWith("/units/factory"):{(0,pages_1.onFactoryPage)();break}case dlp.startsWith("/units/mine"):{(0,pages_1.onMinePage)();break}case dlp.startsWith("/units/sawmill"):{(0,pages_1.onSawmillPage)();break}case dlp.startsWith("/units/fishfarm"):{(0,pages_1.onFishfarmPage)();break}case dlp.startsWith("/units/shop"):{(0,pages_1.onShopPage)();break}case dlp.startsWith("/units/produce/calculator"):{(0,pages_1.onCalculatorPage)();break}case dlp.startsWith("/units/construction"):{(0,pages_1.onConstructionPage)();break}case dlp.startsWith("/units/warehouse"):{(0,pages_1.onWarehousePage)();break}case dlp.startsWith("/analitics"):{(0,pages_1.onAnalyticsPage)();break}case dlp.startsWith("/wikihelp"):{(0,pages_1.onWikiHelpPage)();break}case dlp.startsWith("/competitions/producepoints"):{(0,pages_1.onProducePointsPage)();break}case dlp.startsWith("/competitions/constructionpoints"):{(0,pages_1.onConstructionPointsPage)();break}}})().catch(console.error)})()})();